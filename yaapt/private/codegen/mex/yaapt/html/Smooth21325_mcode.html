<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="200,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">out</span>] = Smooth2(<span class="var type1" id="S3T1U6">arr</span>, <span class="var type1" id="S4T5U7">Prm</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,2" id="srcline2">  2</a></span><span class="line"><span class="mxinfo " id="T2:U4"><span class="var type1" id="S5T2U10">min_length</span> = <span class="mxinfo " id="T2:U6"><span class="var type1" id="S4T5U12">Prm</span>.smooth_threshold</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,3" id="srcline3">  3</a></span><span class="line"><span class="mxinfo " id="T2:U8"><span class="var type1" id="S6T2U16">stable_length</span> = <span class="mxinfo " id="T2:U10">50</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,4" id="srcline4">  4</a></span><span class="line"><span class="mxinfo " id="T2:U11"><span class="var type1" id="S7T2U20">absorb_threshold</span> = <span class="mxinfo " id="T2:U13">0.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,5" id="srcline5">  5</a></span><span class="line"><span class="mxinfo " id="T2:U14"><span class="var type1" id="S8T2U24">pivot</span> = <span class="mxinfo " id="T2:U16"><span class="var type1" id="S3T1U26">arr</span>(<span class="mxinfo " id="T2:U18">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,6" id="srcline6">  6</a></span><span class="line"><span class="mxinfo " id="T1:U19"><span class="var type1" id="S9T1U30">headidx</span> = <span class="mxinfo " id="T2:U21">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,7" id="srcline7">  7</a></span><span class="line"><span class="mxinfo " id="T1:U22"><span class="var type1" id="S10T1U34">headpitches</span> = <span class="mxinfo " id="T2:U24"><span class="var type1" id="S3T1U36">arr</span>(<span class="mxinfo " id="T2:U26">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,8" id="srcline8">  8</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T2U40">i</span>=<span class="mxinfo " id="T2:U28">1</span>:length(<span class="var type1" id="S3T1U45">arr</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,9" id="srcline9">  9</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo " id="T4:U30"><span class="mxinfo " id="T2:U31"><span class="var type1" id="S3T1U51">arr</span>(<span class="var type1" id="S11T2U52">i</span>)</span>~=<span class="var type1" id="S8T2U53">pivot</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,10" id="srcline10"> 10</a></span><span class="line">        <span class="mxinfo " id="T1:U35"><span class="var type1" id="S9T1U56">headidx</span> = <span class="mxinfo " id="T1:U37">[<span class="var type1" id="S9T1U59">headidx</span> <span class="var type1" id="S11T2U60">i</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,11" id="srcline11"> 11</a></span><span class="line">        <span class="mxinfo " id="T1:U40"><span class="var type1" id="S10T1U63">headpitches</span> = <span class="mxinfo " id="T1:U42">[<span class="var type1" id="S10T1U66">headpitches</span> <span class="mxinfo " id="T2:U44"><span class="var type1" id="S3T1U68">arr</span>(<span class="var type1" id="S11T2U69">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,12" id="srcline12"> 12</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo " id="T2:U47"><span class="var type1" id="S8T2U72">pivot</span>=<span class="mxinfo " id="T2:U49"><span class="var type1" id="S3T1U74">arr</span>(<span class="var type1" id="S11T2U75">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,14" id="srcline14"> 14</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="200,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%idx = 1:length(arr);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T1:U52"><span class="var type1" id="S13T1U78">prev_headidx</span> = <span class="var type1" id="S9T1U79">headidx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T1:U55"><span class="var type1" id="S14T1U82">tmp_headidx</span> = <span class="mxinfo " id="T1:U57">[<span class="var type1" id="S9T1U85">headidx</span> <span class="mxinfo " id="T2:U59">length(<span class="var type1" id="S3T1U88">arr</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T1:U61"><span class="var type1" id="S15T1U91">pitcheslength</span> = <span class="mxinfo " id="T1:U63">diff(<span class="var type1" id="S14T1U94">tmp_headidx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo " id="T1:U65"><span class="var type1" id="S17T1U97">visited</span> = <span class="mxinfo " id="T1:U67">zeros(<span class="mxinfo " id="T2:U68">1</span>,<span class="mxinfo " id="T2:U69">length(<span class="var type1" id="S15T1U103">pitcheslength</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,21" id="srcline21"> 21</a></span><span class="line"><span class="keyword">while</span>(<span class="mxinfo " id="T2:U71">1</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,22" id="srcline22"> 22</a></span><span class="line">    <span class="mxinfo " id="T1:U72"><span class="var type1" id="S14T1U109">tmp_headidx</span> = <span class="mxinfo " id="T1:U74">[<span class="var type1" id="S9T1U112">headidx</span> <span class="mxinfo " id="T2:U76">length(<span class="var type1" id="S3T1U115">arr</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,23" id="srcline23"> 23</a></span><span class="line">    <span class="mxinfo " id="T1:U78"><span class="var type1" id="S15T1U118">pitcheslength</span> = <span class="mxinfo " id="T1:U80">diff(<span class="var type1" id="S14T1U121">tmp_headidx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,24" id="srcline24"> 24</a></span><span class="line">    [<span class="var type1" id="S19T1U125">sorted_pitcheslength</span>,<span class="var type1" id="S20T1U126">sorted_idx</span>]=sort(<span class="var type1" id="S15T1U129">pitcheslength</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="200,25" id="srcline25"> 25</a></span><span class="line">        <span class="keyword">if</span>(<span class="mxinfo " id="T4:U85">all(<span class="mxinfo " id="T7:U86"><span class="var type1" id="S17T1U136">visited</span>==<span class="mxinfo " id="T2:U88">1</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%         if(isequal(prev_headidx,headidx)&amp;&amp; all((diff(tmp_headidx)&gt;min_length | headpitches==0)))</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,27" id="srcline27"> 27</a></span><span class="line">        <span class="keyword">if</span>(<span class="mxinfo " id="T4:U89">isequal(<span class="var type1" id="S13T1U143">prev_headidx</span>,<span class="var type1" id="S9T1U144">headidx</span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,28" id="srcline28"> 28</a></span><span class="line">            <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,29" id="srcline29"> 29</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,30" id="srcline30"> 30</a></span><span class="line">            <span class="mxinfo " id="T1:U92"><span class="var type1" id="S17T1U149">visited</span> = <span class="mxinfo " id="T1:U94">zeros(<span class="mxinfo " id="T2:U95">1</span>,<span class="mxinfo " id="T2:U96">length(<span class="var type1" id="S15T1U155">pitcheslength</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,31" id="srcline31"> 31</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,32" id="srcline32"> 32</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,33" id="srcline33"> 33</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="200,34" id="srcline34"> 34</a></span><span class="line">    <span class="mxinfo " id="T1:U98"><span class="var type1" id="S24T1U158">sorted_pitches</span> = <span class="mxinfo " id="T1:U100"><span class="var type1" id="S10T1U160">headpitches</span>(<span class="var type1" id="S20T1U161">sorted_idx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo " id="T1:U103"><span class="var type1" id="S13T1U164">prev_headidx</span> = <span class="var type1" id="S9T1U165">headidx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,36" id="srcline36"> 36</a></span><span class="line">    <span class="mxinfo " id="T108:U106"><span class="var type1" id="S25T108U168">index</span> = <span class="mxinfo " id="T108:U108">find(<span class="mxinfo " id="T7:U109"><span class="var type1" id="S17T1U172">visited</span>==<span class="mxinfo " id="T2:U111">0</span></span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,37" id="srcline37"> 37</a></span><span class="line">    <span class="mxinfo " id="T108:U112"><span class="mxinfo " id="T108:U113"><span class="var type1" id="S17T1U178">visited</span>(<span class="var type1" id="S25T108U179">index</span>)</span> = <span class="mxinfo " id="T2:U116">1</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="200,38" id="srcline38"> 38</a></span><span class="line">    <span class="comment">%sorted_headidx = headidx(sorted_idx);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="200,40" id="srcline40"> 40</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="200,41" id="srcline41"> 41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="200,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T108:U117"><span class="var type1" id="S27T108U183">check_pitch</span> = <span class="mxinfo " id="T108:U119"><span class="var type1" id="S24T1U185">sorted_pitches</span>(<span class="var type1" id="S25T108U186">index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T108:U122"><span class="var type1" id="S28T108U189">check_pitchlength</span> = <span class="mxinfo " id="T108:U124"><span class="var type1" id="S19T1U191">sorted_pitcheslength</span>(<span class="var type1" id="S25T108U192">index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T108:U127"><span class="var type1" id="S29T108U195">check_idx</span> = <span class="mxinfo " id="T108:U129"><span class="var type1" id="S20T1U197">sorted_idx</span>(<span class="var type1" id="S25T108U198">index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,45" id="srcline45"> 45</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo " id="T4:U132">all(<span class="mxinfo " id="T138:U133"><span class="var type1" id="S29T108U205">check_idx</span>==<span class="mxinfo " id="T2:U135">1</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,46" id="srcline46"> 46</a></span><span class="line">        <span class="mxinfo " id="T108:U136"><span class="var type1" id="S30T108U209">left_pitch</span> = <span class="mxinfo " id="T2:U138">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,47" id="srcline47"> 47</a></span><span class="line">        <span class="mxinfo " id="T108:U139"><span class="var type1" id="S31T108U213">left_pitchlength</span> = <span class="mxinfo " id="T2:U141">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,48" id="srcline48"> 48</a></span><span class="line">        <span class="mxinfo " id="T108:U142"><span class="var type1" id="S32T108U217">right_pitch</span> = <span class="mxinfo " id="T108:U144"><span class="var type1" id="S10T1U219">headpitches</span>(<span class="mxinfo " id="T108:U146"><span class="var type1" id="S29T108U221">check_idx</span>+<span class="mxinfo " id="T2:U148">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,49" id="srcline49"> 49</a></span><span class="line">        <span class="mxinfo " id="T108:U149"><span class="var type1" id="S33T108U225">right_pitchlength</span> = <span class="mxinfo " id="T108:U151"><span class="var type1" id="S15T1U227">pitcheslength</span>(<span class="mxinfo " id="T108:U153"><span class="var type1" id="S29T108U229">check_idx</span>+<span class="mxinfo " id="T2:U155">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,50" id="srcline50"> 50</a></span><span class="line">    <span class="keyword">elseif</span>(<span class="mxinfo " id="T4:U156">all(<span class="mxinfo " id="T138:U157"><span class="var type1" id="S29T108U236">check_idx</span>==<span class="mxinfo " id="T2:U159">length(<span class="var type1" id="S9T1U239">headidx</span>)</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,51" id="srcline51"> 51</a></span><span class="line">        <span class="mxinfo " id="T108:U161"><span class="var type1" id="S30T108U242">left_pitch</span> = <span class="mxinfo " id="T108:U163"><span class="var type1" id="S10T1U244">headpitches</span>(<span class="mxinfo " id="T108:U165"><span class="var type1" id="S29T108U246">check_idx</span>-<span class="mxinfo " id="T2:U167">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,52" id="srcline52"> 52</a></span><span class="line">        <span class="mxinfo " id="T108:U168"><span class="var type1" id="S31T108U250">left_pitchlength</span> = <span class="mxinfo " id="T108:U170"><span class="var type1" id="S15T1U252">pitcheslength</span>(<span class="mxinfo " id="T108:U172"><span class="var type1" id="S29T108U254">check_idx</span>-<span class="mxinfo " id="T2:U174">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,53" id="srcline53"> 53</a></span><span class="line">        <span class="mxinfo " id="T108:U175"><span class="var type1" id="S32T108U258">right_pitch</span> = <span class="mxinfo " id="T2:U177">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,54" id="srcline54"> 54</a></span><span class="line">        <span class="mxinfo " id="T108:U178"><span class="var type1" id="S33T108U262">right_pitchlength</span> = <span class="mxinfo " id="T2:U180">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,55" id="srcline55"> 55</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,56" id="srcline56"> 56</a></span><span class="line">        <span class="mxinfo " id="T108:U181"><span class="var type1" id="S30T108U267">left_pitch</span> = <span class="mxinfo " id="T108:U183"><span class="var type1" id="S10T1U269">headpitches</span>(<span class="mxinfo " id="T108:U185"><span class="var type1" id="S29T108U271">check_idx</span>-<span class="mxinfo " id="T2:U187">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo " id="T108:U188"><span class="var type1" id="S31T108U275">left_pitchlength</span> = <span class="mxinfo " id="T108:U190"><span class="var type1" id="S15T1U277">pitcheslength</span>(<span class="mxinfo " id="T108:U192"><span class="var type1" id="S29T108U279">check_idx</span>-<span class="mxinfo " id="T2:U194">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,58" id="srcline58"> 58</a></span><span class="line">        <span class="mxinfo " id="T108:U195"><span class="var type1" id="S32T108U283">right_pitch</span> = <span class="mxinfo " id="T108:U197"><span class="var type1" id="S10T1U285">headpitches</span>(<span class="mxinfo " id="T108:U199"><span class="var type1" id="S29T108U287">check_idx</span>+<span class="mxinfo " id="T2:U201">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,59" id="srcline59"> 59</a></span><span class="line">        <span class="mxinfo " id="T108:U202"><span class="var type1" id="S33T108U291">right_pitchlength</span> = <span class="mxinfo " id="T108:U204"><span class="var type1" id="S15T1U293">pitcheslength</span>(<span class="mxinfo " id="T108:U206"><span class="var type1" id="S29T108U295">check_idx</span>+<span class="mxinfo " id="T2:U208">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,60" id="srcline60"> 60</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,61" id="srcline61"> 61</a></span><span class="line">    <span class="comment">%Smooth Criteria</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,62" id="srcline62"> 62</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo " id="T4:U209">all(<span class="mxinfo " id="T138:U210"><span class="var type1" id="S27T108U303">check_pitch</span> ~= <span class="mxinfo " id="T2:U212">0</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,63" id="srcline63"> 63</a></span><span class="line">        <span class="mxinfo " id="T4:U213"><span class="keyword">if</span>(<span class="mxinfo " id="T4:U214"><span class="mxinfo " id="T4:U215">all(<span class="mxinfo " id="T138:U216"><span class="var type1" id="S30T108U312">left_pitch</span>==<span class="mxinfo " id="T2:U218">0</span></span>)</span> &amp;&amp; <span class="mxinfo " id="T4:U219">all(<span class="mxinfo " id="T138:U220"><span class="var type1" id="S32T108U317">right_pitch</span> == <span class="mxinfo " id="T2:U222">0</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,64" id="srcline64"> 64</a></span><span class="line">            <span class="keyword">if</span>(<span class="mxinfo " id="T4:U223">all(<span class="mxinfo " id="T138:U224"><span class="var type1" id="S28T108U325">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U326">min_length</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,65" id="srcline65"> 65</a></span><span class="line">                <span class="mxinfo " id="T1:U227"><span class="var type1" id="S9T1U329">headidx</span> = <span class="mxinfo " id="T1:U229"><span class="var type1" id="S9T1U331">headidx</span>(<span class="mxinfo " id="T1:U231">[<span class="mxinfo " id="T1:U232">1:<span class="mxinfo " id="T108:U233"><span class="var type1" id="S29T108U337">check_idx</span>-<span class="mxinfo " id="T2:U235">1</span></span></span>, <span class="mxinfo " id="T1:U236"><span class="mxinfo " id="T108:U237"><span class="var type1" id="S29T108U341">check_idx</span>+<span class="mxinfo " id="T2:U239">2</span></span>:<span class="mxinfo " id="T2:U240">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,66" id="srcline66"> 66</a></span><span class="line">                <span class="mxinfo " id="T1:U241"><span class="var type1" id="S10T1U347">headpitches</span> = <span class="mxinfo " id="T1:U243"><span class="var type1" id="S10T1U349">headpitches</span>(<span class="mxinfo " id="T1:U245">[<span class="mxinfo " id="T1:U246">1:<span class="mxinfo " id="T108:U247"><span class="var type1" id="S29T108U355">check_idx</span>-<span class="mxinfo " id="T2:U249">1</span></span></span>, <span class="mxinfo " id="T1:U250"><span class="mxinfo " id="T108:U251"><span class="var type1" id="S29T108U359">check_idx</span>+<span class="mxinfo " id="T2:U253">2</span></span>:<span class="mxinfo " id="T2:U254">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,67" id="srcline67"> 67</a></span><span class="line">                <span class="mxinfo " id="T1:U255"><span class="var type1" id="S17T1U365">visited</span> = <span class="mxinfo " id="T1:U257"><span class="var type1" id="S17T1U367">visited</span>(<span class="mxinfo " id="T1:U259">[<span class="mxinfo " id="T1:U260">1:<span class="mxinfo " id="T108:U261"><span class="var type1" id="S25T108U373">index</span>-<span class="mxinfo " id="T2:U263">1</span></span></span>, <span class="mxinfo " id="T1:U264"><span class="mxinfo " id="T108:U265"><span class="var type1" id="S25T108U377">index</span>+<span class="mxinfo " id="T2:U267">2</span></span>:<span class="mxinfo " id="T2:U268">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,68" id="srcline68"> 68</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,69" id="srcline69"> 69</a></span><span class="line">        <span class="keyword">elseif</span>(<span class="mxinfo " id="T4:U270"><span class="mxinfo " id="T4:U271">all(<span class="mxinfo " id="T138:U272"><span class="var type1" id="S30T108U387">left_pitch</span> ~= <span class="mxinfo " id="T2:U274">0</span></span>)</span> &amp;&amp; <span class="mxinfo " id="T4:U275">all(<span class="mxinfo " id="T138:U276"><span class="var type1" id="S32T108U392">right_pitch</span> == <span class="mxinfo " id="T2:U278">0</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,70" id="srcline70"> 70</a></span><span class="line">            <span class="mxinfo " id="T4:U279"><span class="keyword">if</span>(<span class="mxinfo " id="T4:U280">(<span class="mxinfo " id="T4:U281">all(<span class="mxinfo " id="T138:U282"><span class="mxinfo " id="T108:U283"><span class="var type1" id="S28T108U404">check_pitchlength</span>/<span class="var type1" id="S31T108U405">left_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U406">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T4:U287">all(<span class="mxinfo " id="T138:U288"><span class="var type1" id="S28T108U410">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U411">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T4:U291">all(<span class="mxinfo " id="T138:U292"><span class="var type1" id="S28T108U415">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U416">stable_length</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,71" id="srcline71"> 71</a></span><span class="line">                <span class="mxinfo " id="T1:U295"><span class="var type1" id="S9T1U419">headidx</span> = <span class="mxinfo " id="T1:U297"><span class="var type1" id="S9T1U421">headidx</span>(<span class="mxinfo " id="T1:U299">[<span class="mxinfo " id="T1:U300">1:<span class="mxinfo " id="T108:U301"><span class="var type1" id="S29T108U427">check_idx</span>-<span class="mxinfo " id="T2:U303">1</span></span></span>, <span class="mxinfo " id="T1:U304"><span class="mxinfo " id="T108:U305"><span class="var type1" id="S29T108U431">check_idx</span>+<span class="mxinfo " id="T2:U307">1</span></span>:<span class="mxinfo " id="T2:U308">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,72" id="srcline72"> 72</a></span><span class="line">                <span class="mxinfo " id="T1:U309"><span class="var type1" id="S10T1U437">headpitches</span> = <span class="mxinfo " id="T1:U311"><span class="var type1" id="S10T1U439">headpitches</span>(<span class="mxinfo " id="T1:U313">[<span class="mxinfo " id="T1:U314">1:<span class="mxinfo " id="T108:U315"><span class="var type1" id="S29T108U445">check_idx</span>-<span class="mxinfo " id="T2:U317">1</span></span></span>, <span class="mxinfo " id="T1:U318"><span class="mxinfo " id="T108:U319"><span class="var type1" id="S29T108U449">check_idx</span>+<span class="mxinfo " id="T2:U321">1</span></span>:<span class="mxinfo " id="T2:U322">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,73" id="srcline73"> 73</a></span><span class="line">                <span class="mxinfo " id="T1:U323"><span class="var type1" id="S17T1U455">visited</span> = <span class="mxinfo " id="T1:U325"><span class="var type1" id="S17T1U457">visited</span>(<span class="mxinfo " id="T1:U327">[<span class="mxinfo " id="T1:U328">1:<span class="mxinfo " id="T108:U329"><span class="var type1" id="S25T108U463">index</span>-<span class="mxinfo " id="T2:U331">1</span></span></span>, <span class="mxinfo " id="T1:U332"><span class="mxinfo " id="T108:U333"><span class="var type1" id="S25T108U467">index</span>+<span class="mxinfo " id="T2:U335">1</span></span>:<span class="mxinfo " id="T2:U336">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,74" id="srcline74"> 74</a></span><span class="line">            <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="200,75" id="srcline75"> 75</a></span><span class="line">        <span class="keyword">elseif</span>(<span class="mxinfo " id="T4:U338"><span class="mxinfo " id="T4:U339">all(<span class="mxinfo " id="T138:U340"><span class="var type1" id="S30T108U477">left_pitch</span> == <span class="mxinfo " id="T2:U342">0</span></span>)</span> &amp;&amp; <span class="mxinfo " id="T4:U343">all(<span class="mxinfo " id="T138:U344"><span class="var type1" id="S32T108U482">right_pitch</span> ~= <span class="mxinfo " id="T2:U346">0</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,76" id="srcline76"> 76</a></span><span class="line">            <span class="mxinfo " id="T4:U347"><span class="keyword">if</span>(<span class="mxinfo " id="T4:U348">(<span class="mxinfo " id="T4:U349">all(<span class="mxinfo " id="T138:U350"><span class="mxinfo " id="T108:U351"><span class="var type1" id="S28T108U494">check_pitchlength</span>/<span class="var type1" id="S33T108U495">right_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U496">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T4:U355">all(<span class="mxinfo " id="T138:U356"><span class="var type1" id="S28T108U500">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U501">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T4:U359">all(<span class="mxinfo " id="T138:U360"><span class="var type1" id="S28T108U505">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U506">stable_length</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,77" id="srcline77"> 77</a></span><span class="line">                <span class="mxinfo " id="T108:U363"><span class="var type1" id="S35T108U509">temp</span> = <span class="mxinfo " id="T108:U365"><span class="var type1" id="S9T1U511">headidx</span>(<span class="var type1" id="S29T108U512">check_idx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,78" id="srcline78"> 78</a></span><span class="line">                <span class="mxinfo " id="T1:U368"><span class="var type1" id="S9T1U515">headidx</span> = <span class="mxinfo " id="T1:U370"><span class="var type1" id="S9T1U517">headidx</span>(<span class="mxinfo " id="T1:U372">[<span class="mxinfo " id="T1:U373">1:<span class="mxinfo " id="T108:U374"><span class="var type1" id="S29T108U523">check_idx</span>-<span class="mxinfo " id="T2:U376">1</span></span></span>, <span class="mxinfo " id="T1:U377"><span class="mxinfo " id="T108:U378"><span class="var type1" id="S29T108U527">check_idx</span>+<span class="mxinfo " id="T2:U380">1</span></span>:<span class="mxinfo " id="T2:U381">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,79" id="srcline79"> 79</a></span><span class="line">                <span class="mxinfo " id="T108:U382"><span class="mxinfo " id="T108:U383"><span class="var type1" id="S9T1U534">headidx</span>(<span class="var type1" id="S29T108U535">check_idx</span>)</span> = <span class="var type1" id="S35T108U536">temp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,80" id="srcline80"> 80</a></span><span class="line">                <span class="mxinfo " id="T1:U387"><span class="var type1" id="S10T1U539">headpitches</span> = <span class="mxinfo " id="T1:U389"><span class="var type1" id="S10T1U541">headpitches</span>(<span class="mxinfo " id="T1:U391">[<span class="mxinfo " id="T1:U392">1:<span class="mxinfo " id="T108:U393"><span class="var type1" id="S29T108U547">check_idx</span>-<span class="mxinfo " id="T2:U395">1</span></span></span>, <span class="mxinfo " id="T1:U396"><span class="mxinfo " id="T108:U397"><span class="var type1" id="S29T108U551">check_idx</span>+<span class="mxinfo " id="T2:U399">1</span></span>:<span class="mxinfo " id="T2:U400">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,81" id="srcline81"> 81</a></span><span class="line">                <span class="mxinfo " id="T1:U401"><span class="var type1" id="S17T1U557">visited</span> = <span class="mxinfo " id="T1:U403"><span class="var type1" id="S17T1U559">visited</span>(<span class="mxinfo " id="T1:U405">[<span class="mxinfo " id="T1:U406">1:<span class="mxinfo " id="T108:U407"><span class="var type1" id="S25T108U565">index</span>-<span class="mxinfo " id="T2:U409">1</span></span></span>, <span class="mxinfo " id="T1:U410"><span class="mxinfo " id="T108:U411"><span class="var type1" id="S25T108U569">index</span>+<span class="mxinfo " id="T2:U413">1</span></span>:<span class="mxinfo " id="T2:U414">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,82" id="srcline82"> 82</a></span><span class="line">            <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="200,83" id="srcline83"> 83</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,84" id="srcline84"> 84</a></span><span class="line">           <span class="keyword">if</span>(<span class="mxinfo " id="T4:U415">all(<span class="mxinfo " id="T138:U416"><span class="var type1" id="S31T108U580">left_pitchlength</span>&gt;<span class="var type1" id="S33T108U581">right_pitchlength</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,85" id="srcline85"> 85</a></span><span class="line">               <span class="mxinfo " id="T4:U419"><span class="keyword">if</span>(<span class="mxinfo " id="T4:U420">(<span class="mxinfo " id="T4:U421">all(<span class="mxinfo " id="T138:U422"><span class="mxinfo " id="T108:U423"><span class="var type1" id="S28T108U592">check_pitchlength</span>/<span class="var type1" id="S31T108U593">left_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U594">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T4:U427">all(<span class="mxinfo " id="T138:U428"><span class="var type1" id="S28T108U598">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U599">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T4:U431">all(<span class="mxinfo " id="T138:U432"><span class="var type1" id="S28T108U603">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U604">stable_length</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,86" id="srcline86"> 86</a></span><span class="line">                    <span class="mxinfo " id="T1:U435"><span class="var type1" id="S9T1U607">headidx</span> = <span class="mxinfo " id="T1:U437"><span class="var type1" id="S9T1U609">headidx</span>(<span class="mxinfo " id="T1:U439">[<span class="mxinfo " id="T1:U440">1:<span class="mxinfo " id="T108:U441"><span class="var type1" id="S29T108U615">check_idx</span>-<span class="mxinfo " id="T2:U443">1</span></span></span>, <span class="mxinfo " id="T1:U444"><span class="mxinfo " id="T108:U445"><span class="var type1" id="S29T108U619">check_idx</span>+<span class="mxinfo " id="T2:U447">1</span></span>:<span class="mxinfo " id="T2:U448">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,87" id="srcline87"> 87</a></span><span class="line">                    <span class="mxinfo " id="T1:U449"><span class="var type1" id="S10T1U625">headpitches</span> = <span class="mxinfo " id="T1:U451"><span class="var type1" id="S10T1U627">headpitches</span>(<span class="mxinfo " id="T1:U453">[<span class="mxinfo " id="T1:U454">1:<span class="mxinfo " id="T108:U455"><span class="var type1" id="S29T108U633">check_idx</span>-<span class="mxinfo " id="T2:U457">1</span></span></span>, <span class="mxinfo " id="T1:U458"><span class="mxinfo " id="T108:U459"><span class="var type1" id="S29T108U637">check_idx</span>+<span class="mxinfo " id="T2:U461">1</span></span>:<span class="mxinfo " id="T2:U462">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,88" id="srcline88"> 88</a></span><span class="line">                    <span class="mxinfo " id="T1:U463"><span class="var type1" id="S17T1U643">visited</span> = <span class="mxinfo " id="T1:U465"><span class="var type1" id="S17T1U645">visited</span>(<span class="mxinfo " id="T1:U467">[<span class="mxinfo " id="T1:U468">1:<span class="mxinfo " id="T108:U469"><span class="var type1" id="S25T108U651">index</span>-<span class="mxinfo " id="T2:U471">1</span></span></span>, <span class="mxinfo " id="T1:U472"><span class="mxinfo " id="T108:U473"><span class="var type1" id="S25T108U655">index</span>+<span class="mxinfo " id="T2:U475">1</span></span>:<span class="mxinfo " id="T2:U476">end</span></span>]</span>)</span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="200,89" id="srcline89"> 89</a></span><span class="line">               <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="200,90" id="srcline90"> 90</a></span><span class="line">           <span class="keyword">elseif</span>(<span class="mxinfo " id="T4:U477">all(<span class="mxinfo " id="T138:U478"><span class="var type1" id="S31T108U664">left_pitchlength</span> &lt; <span class="var type1" id="S33T108U665">right_pitchlength</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,91" id="srcline91"> 91</a></span><span class="line">               <span class="mxinfo " id="T4:U481"><span class="keyword">if</span>(<span class="mxinfo " id="T4:U482">(<span class="mxinfo " id="T4:U483">all(<span class="mxinfo " id="T138:U484"><span class="mxinfo " id="T108:U485"><span class="var type1" id="S28T108U676">check_pitchlength</span>/<span class="var type1" id="S31T108U677">left_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U678">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T4:U489">all(<span class="mxinfo " id="T138:U490"><span class="var type1" id="S28T108U682">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U683">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T4:U493">all(<span class="mxinfo " id="T138:U494"><span class="var type1" id="S28T108U687">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U688">stable_length</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,92" id="srcline92"> 92</a></span><span class="line">                    <span class="mxinfo " id="T108:U497"><span class="var type1" id="S35T108U691">temp</span> = <span class="mxinfo " id="T108:U499"><span class="var type1" id="S9T1U693">headidx</span>(<span class="var type1" id="S29T108U694">check_idx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,93" id="srcline93"> 93</a></span><span class="line">                    <span class="mxinfo " id="T1:U502"><span class="var type1" id="S9T1U697">headidx</span> = <span class="mxinfo " id="T1:U504"><span class="var type1" id="S9T1U699">headidx</span>(<span class="mxinfo " id="T1:U506">[<span class="mxinfo " id="T1:U507">1:<span class="mxinfo " id="T108:U508"><span class="var type1" id="S29T108U705">check_idx</span>-<span class="mxinfo " id="T2:U510">1</span></span></span>, <span class="mxinfo " id="T1:U511"><span class="mxinfo " id="T108:U512"><span class="var type1" id="S29T108U709">check_idx</span>+<span class="mxinfo " id="T2:U514">1</span></span>:<span class="mxinfo " id="T2:U515">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,94" id="srcline94"> 94</a></span><span class="line">                    <span class="mxinfo " id="T108:U516"><span class="mxinfo " id="T108:U517"><span class="var type1" id="S9T1U716">headidx</span>(<span class="var type1" id="S29T108U717">check_idx</span>)</span> = <span class="var type1" id="S35T108U718">temp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,95" id="srcline95"> 95</a></span><span class="line">                    <span class="mxinfo " id="T1:U521"><span class="var type1" id="S10T1U721">headpitches</span> = <span class="mxinfo " id="T1:U523"><span class="var type1" id="S10T1U723">headpitches</span>(<span class="mxinfo " id="T1:U525">[<span class="mxinfo " id="T1:U526">1:<span class="mxinfo " id="T108:U527"><span class="var type1" id="S29T108U729">check_idx</span>-<span class="mxinfo " id="T2:U529">1</span></span></span>, <span class="mxinfo " id="T1:U530"><span class="mxinfo " id="T108:U531"><span class="var type1" id="S29T108U733">check_idx</span>+<span class="mxinfo " id="T2:U533">1</span></span>:<span class="mxinfo " id="T2:U534">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,96" id="srcline96"> 96</a></span><span class="line">                    <span class="mxinfo " id="T1:U535"><span class="var type1" id="S17T1U739">visited</span> = <span class="mxinfo " id="T1:U537"><span class="var type1" id="S17T1U741">visited</span>(<span class="mxinfo " id="T1:U539">[<span class="mxinfo " id="T1:U540">1:<span class="mxinfo " id="T108:U541"><span class="var type1" id="S25T108U747">index</span>-<span class="mxinfo " id="T2:U543">1</span></span></span>, <span class="mxinfo " id="T1:U544"><span class="mxinfo " id="T108:U545"><span class="var type1" id="S25T108U751">index</span>+<span class="mxinfo " id="T2:U547">1</span></span>:<span class="mxinfo " id="T2:U548">end</span></span>]</span>)</span></span>;                   </span></span>
<span class="srcline"><span class="lineno"><a href="200,97" id="srcline97"> 97</a></span><span class="line">               <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="200,98" id="srcline98"> 98</a></span><span class="line">           <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,99" id="srcline99"> 99</a></span><span class="line">               <span class="mxinfo " id="T4:U549"><span class="keyword">if</span>(<span class="mxinfo " id="T4:U550">(<span class="mxinfo " id="T4:U551">all(<span class="mxinfo " id="T138:U552"><span class="mxinfo " id="T108:U553"><span class="var type1" id="S28T108U766">check_pitchlength</span>/(<span class="mxinfo " id="T108:U555"><span class="var type1" id="S31T108U769">left_pitchlength</span>+<span class="var type1" id="S33T108U770">right_pitchlength</span></span>)</span>&lt;<span class="var type1" id="S7T2U771">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T4:U559">all(<span class="mxinfo " id="T138:U560"><span class="var type1" id="S28T108U775">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U776">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T4:U563">all(<span class="mxinfo " id="T138:U564"><span class="var type1" id="S28T108U780">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U781">stable_length</span></span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,100" id="srcline100">100</a></span><span class="line">                   <span class="mxinfo " id="T1:U567"><span class="var type1" id="S9T1U784">headidx</span> = <span class="mxinfo " id="T1:U569"><span class="var type1" id="S9T1U786">headidx</span>(<span class="mxinfo " id="T1:U571">[<span class="mxinfo " id="T1:U572">1:<span class="mxinfo " id="T108:U573"><span class="var type1" id="S29T108U792">check_idx</span>-<span class="mxinfo " id="T2:U575">1</span></span></span>, <span class="mxinfo " id="T1:U576"><span class="mxinfo " id="T108:U577"><span class="var type1" id="S29T108U796">check_idx</span>+<span class="mxinfo " id="T2:U579">2</span></span>:<span class="mxinfo " id="T2:U580">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,101" id="srcline101">101</a></span><span class="line">                   <span class="mxinfo " id="T1:U581"><span class="var type1" id="S10T1U802">headpitches</span> = <span class="mxinfo " id="T1:U583"><span class="var type1" id="S10T1U804">headpitches</span>(<span class="mxinfo " id="T1:U585">[<span class="mxinfo " id="T1:U586">1:<span class="mxinfo " id="T108:U587"><span class="var type1" id="S29T108U810">check_idx</span>-<span class="mxinfo " id="T2:U589">1</span></span></span>, <span class="mxinfo " id="T1:U590"><span class="mxinfo " id="T108:U591"><span class="var type1" id="S29T108U814">check_idx</span>+<span class="mxinfo " id="T2:U593">2</span></span>:<span class="mxinfo " id="T2:U594">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,102" id="srcline102">102</a></span><span class="line">                   <span class="mxinfo " id="T1:U595"><span class="var type1" id="S17T1U820">visited</span> = <span class="mxinfo " id="T1:U597"><span class="var type1" id="S17T1U822">visited</span>(<span class="mxinfo " id="T1:U599">[<span class="mxinfo " id="T1:U600">1:<span class="mxinfo " id="T108:U601"><span class="var type1" id="S25T108U828">index</span>-<span class="mxinfo " id="T2:U603">1</span></span></span>, <span class="mxinfo " id="T1:U604"><span class="mxinfo " id="T108:U605"><span class="var type1" id="S25T108U832">index</span>+<span class="mxinfo " id="T2:U607">2</span></span>:<span class="mxinfo " id="T2:U608">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,103" id="srcline103">103</a></span><span class="line">               <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="200,104" id="srcline104">104</a></span><span class="line">           <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,105" id="srcline105">105</a></span><span class="line">        <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="200,106" id="srcline106">106</a></span><span class="line"><span class="comment">%     elseif(check_idx~=1&amp;&amp;check_idx~=length(headidx))</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,107" id="srcline107">107</a></span><span class="line"><span class="comment">%            if(left_pitchlength&gt;right_pitchlength)</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,108" id="srcline108">108</a></span><span class="line"><span class="comment">%                if(((check_pitchlength/left_pitchlength&lt;absorb_threshold)||check_pitchlength&lt;min_length)&amp;&amp;check_pitchlength&lt;stable_length)</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,109" id="srcline109">109</a></span><span class="line"><span class="comment">%                     headidx = headidx([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,110" id="srcline110">110</a></span><span class="line"><span class="comment">%                     headpitches = headpitches([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,111" id="srcline111">111</a></span><span class="line"><span class="comment">%                     visited = visited([1:index-1, index+1:end]);             </span></span></span>
<span class="srcline"><span class="lineno"><a href="200,112" id="srcline112">112</a></span><span class="line"><span class="comment">%                end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,113" id="srcline113">113</a></span><span class="line"><span class="comment">%            elseif(left_pitchlength &lt; right_pitchlength)</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,114" id="srcline114">114</a></span><span class="line"><span class="comment">%                if(((check_pitchlength/left_pitchlength&lt;absorb_threshold)||check_pitchlength&lt;min_length)&amp;&amp;check_pitchlength&lt;stable_length)</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,115" id="srcline115">115</a></span><span class="line"><span class="comment">%                     temp = headidx(check_idx);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,116" id="srcline116">116</a></span><span class="line"><span class="comment">%                     headidx = headidx([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,117" id="srcline117">117</a></span><span class="line"><span class="comment">%                     headidx(check_idx) = temp;</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,118" id="srcline118">118</a></span><span class="line"><span class="comment">%                     headpitches = headpitches([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,119" id="srcline119">119</a></span><span class="line"><span class="comment">%                     visited = visited([1:index-1, index+1:end]);                   </span></span></span>
<span class="srcline"><span class="lineno"><a href="200,120" id="srcline120">120</a></span><span class="line"><span class="comment">%                end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,121" id="srcline121">121</a></span><span class="line"><span class="comment">%            else</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,122" id="srcline122">122</a></span><span class="line"><span class="comment">%                if(((check_pitchlength/(left_pitchlength+right_pitchlength)&lt;absorb_threshold)||check_pitchlength&lt;min_length)&amp;&amp;check_pitchlength&lt;stable_length)</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,123" id="srcline123">123</a></span><span class="line"><span class="comment">%                    headidx = headidx([1:check_idx-1, check_idx+2:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,124" id="srcline124">124</a></span><span class="line"><span class="comment">%                    headpitches = headpitches([1:check_idx-1, check_idx+2:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,125" id="srcline125">125</a></span><span class="line"><span class="comment">%                    visited = visited([1:index-1, index+2:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,126" id="srcline126">126</a></span><span class="line"><span class="comment">%                end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,127" id="srcline127">127</a></span><span class="line"><span class="comment">%            end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,128" id="srcline128">128</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,129" id="srcline129">129</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="200,130" id="srcline130">130</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,131" id="srcline131">131</a></span><span class="line"><span class="mxinfo " id="T1:U609"><span class="var type1" id="S2T1U838">out</span> = <span class="mxinfo " id="T1:U611">zeros(<span class="mxinfo " id="T2:U612">1</span>,<span class="mxinfo " id="T2:U613">length(<span class="var type1" id="S3T1U844">arr</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,132" id="srcline132">132</a></span><span class="line"><span class="mxinfo " id="T1:U615"><span class="var type1" id="S14T1U847">tmp_headidx</span> = <span class="mxinfo " id="T1:U617">[<span class="var type1" id="S9T1U850">headidx</span> <span class="mxinfo " id="T2:U619">length(<span class="var type1" id="S3T1U853">arr</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,133" id="srcline133">133</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T2U856">i</span>=<span class="mxinfo " id="T2:U622">1</span>:length(<span class="var type1" id="S9T1U861">headidx</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="200,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo " id="T1:U624"><span class="mxinfo " id="T1:U625"><span class="var type1" id="S2T1U865">out</span>(<span class="mxinfo " id="T1:U627"><span class="mxinfo " id="T2:U628"><span class="var type1" id="S14T1U868">tmp_headidx</span>(<span class="var type1" id="S11T2U869">i</span>)</span>:<span class="mxinfo " id="T2:U631"><span class="var type1" id="S14T1U871">tmp_headidx</span>(<span class="mxinfo " id="T2:U633"><span class="var type1" id="S11T2U873">i</span>+<span class="mxinfo " id="T2:U635">1</span></span>)</span></span>)</span> = <span class="mxinfo " id="T1:U636"><span class="mxinfo " id="T2:U637"><span class="var type1" id="S10T1U877">headpitches</span>(<span class="var type1" id="S11T2U878">i</span>)</span>.*<span class="mxinfo " id="T1:U640">ones(<span class="mxinfo " id="T2:U641">1</span>,<span class="mxinfo " id="T2:U642"><span class="mxinfo " id="T2:U643"><span class="mxinfo " id="T2:U644"><span class="var type1" id="S14T1U885">tmp_headidx</span>(<span class="mxinfo " id="T2:U646"><span class="var type1" id="S11T2U887">i</span>+<span class="mxinfo " id="T2:U648">1</span></span>)</span>-<span class="mxinfo " id="T2:U649"><span class="var type1" id="S14T1U890">tmp_headidx</span>(<span class="var type1" id="S11T2U891">i</span>)</span></span>+<span class="mxinfo " id="T2:U652">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="200,135" id="srcline135">135</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="200,136" id="srcline136">136</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="200,137" id="srcline137">137</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="200,138" id="srcline138">138</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="200,139" id="srcline139">139</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="200,140" id="srcline140">140</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="200,141" id="srcline141">141</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
