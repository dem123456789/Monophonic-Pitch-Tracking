<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="131,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T51U3">b</span> = Mybesseli(<span class="var type1" id="S3T2U6">alpha</span>,<span class="var type1" id="S4T51U7">xx</span>,<span class="var type0" id="S5T0U8">scale</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%BESSELI Modified Bessel functions of the first kind.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%   I = BESSELI(ALPHA,X) computes modified Bessel functions of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%   first kind, I_sub_alpha(X) for real, non-negative order ALPHA</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%   and argument X.  In general, both ALPHA and X may be vectors.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%   The output I is m-by-n with m = length(X), n = length(ALPHA) and</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%       I(k,j) = I_sub_alpha(j)(X(k)).</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   The elements of X can be any nonnegative real values in any order.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   For ALPHA there are two important restrictions: the increment</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%   in ALPHA must be one, i.e. ALPHA = alpha:1:alpha+n-1, and the</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%   elements must also be in the range 0 &lt;= ALPHA(j) &lt;= 1000.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%   E = BESSELI(ALPHA,X,1) computes I_sub_alpha(X)*EXP(-X).</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%   The relationship between the Bessel functions of the first kind is</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%       I_sub_alpha(x) = i^(-alpha) * J_sub_alpha(i*x)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%   Examples:</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%       besseli(3:9,[0:.2:9.8 10:.5:20],1) generates the entire </span></span></span>
<span class="srcline"><span class="lineno"><a href="131,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%       71-by-7 table on page 423 of Abramowitz and Stegun,</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%       "Handbook of Mathematical Functions."</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%   See also: BESSELJ, BESSELY, BESSELK.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%   Acknowledgement:</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%   This program is based on a Fortran program by W. J. Cody and</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%   L. Stoltz, Applied Mathematics Division, Argonne National</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%   Laboratory, dated May 30, 1989.  Their references include:</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%      "A Note on backward recurrence algorithms," Olver, F. W. J.,</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%      and Sookne, D. J., Math. Comp. 26, 1972, pp 941-947.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%      "Bessel functions of real argument and integer order,"</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%      Sookne, D. J., NBS Jour. of Res. B. 77b, 1973, pp. 125-132.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%      "Algorithm 597, Sequence of modified Bessel functions of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%      "first kind," Cody, W. J., Trans. Math. Soft., 1983, pp. 242-245.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%   MATLAB version: C. Moler, 10/6/92.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%   Copyright (c) 1984-94 by The MathWorks, Inc.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,44" id="srcline44"> 44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%  Check for real, non-negative arguments.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,48" id="srcline48"> 48</a></span><span class="line">   <span class="keyword">if</span> nargin &lt; 3, <span class="mxinfo" id="T2:U4"><span class="var type1" id="S5T2U17">scale</span> = <span class="mxinfo" id="T2:U6">0</span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,49" id="srcline49"> 49</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T4:U7">any(<span class="mxinfo" id="T51:U8">imag(<span class="var type1" id="S4T51U28">xx</span>)</span>)</span> | <span class="mxinfo" id="T4:U10">any(<span class="mxinfo" id="T50:U11"><span class="var type1" id="S4T51U32">xx</span> &lt; <span class="mxinfo" id="T2:U13">0</span></span>)</span> | any(imag(<span class="var type1" id="S3T2U38">alpha</span>)) | any(<span class="var type1" id="S3T2U42">alpha</span> &lt; 0)</span></span>
<span class="srcline"><span class="lineno"><a href="131,50" id="srcline50"> 50</a></span><span class="line">      error(<span class="string">'Input arguments must be real and nonnegative.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,51" id="srcline51"> 51</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,52" id="srcline52"> 52</a></span><span class="line">   <span class="keyword">if</span> isempty(<span class="mxinfo" id="T2:U16"><span class="var type1" id="S3T2U53">alpha</span></span>) | <span class="mxinfo" id="T4:U18">isempty(<span class="var type1" id="S4T51U56">xx</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,53" id="srcline53"> 53</a></span><span class="line">      <span class="mxinfo" id="T9:U20"><span class="var type1" id="S11T9U59">bk</span> = <span class="mxinfo" id="T9:U22">[]</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="131,54" id="srcline54"> 54</a></span><span class="line">      <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,55" id="srcline55"> 55</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%  Break alpha into integer and fractional parts,</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%  and initialize result array.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,60" id="srcline60"> 60</a></span><span class="line">   <span class="mxinfo" id="T2:U23"><span class="var type1" id="S12T2U65">nfirst</span> = <span class="mxinfo" id="T2:U25">fix(<span class="var type1" id="S3T2U69">alpha</span>(1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,61" id="srcline61"> 61</a></span><span class="line">   <span class="mxinfo" id="T2:U27"><span class="var type1" id="S14T2U73">nb</span> = <span class="mxinfo" id="T2:U29">fix(<span class="var type1" id="S3T2U78">alpha</span>(length(<span class="var type1" id="S3T2U81">alpha</span>))) + 1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,62" id="srcline62"> 62</a></span><span class="line">   <span class="keyword">if</span> ~(<span class="var type1" id="S14T2U88">nb</span> &lt;= 1001)</span></span>
<span class="srcline"><span class="lineno"><a href="131,63" id="srcline63"> 63</a></span><span class="line">      error(<span class="string">'Alpha must be &lt;= 1000.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,64" id="srcline64"> 64</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,65" id="srcline65"> 65</a></span><span class="line">   <span class="keyword">if</span> length(<span class="var type1" id="S3T2U99">alpha</span>) &gt; 1</span></span>
<span class="srcline"><span class="lineno"><a href="131,66" id="srcline66"> 66</a></span><span class="line">      <span class="keyword">if</span> any(abs(diff(<span class="var type0" id="S3T0U111">alpha</span>)-1) &gt; 4*<span class="var type0" id="S14T0U116">nb</span>*eps)</span></span>
<span class="srcline"><span class="lineno"><a href="131,67" id="srcline67"> 67</a></span><span class="line">         error(<span class="string">'Increment in alpha must be 1.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,68" id="srcline68"> 68</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,69" id="srcline69"> 69</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,70" id="srcline70"> 70</a></span><span class="line">   <span class="mxinfo" id="T4:U34"><span class="var type1" id="S19T4U125">resize</span> = (<span class="mxinfo" id="T4:U36">length(<span class="var type1" id="S3T2U130">alpha</span>) == 1</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,71" id="srcline71"> 71</a></span><span class="line">   <span class="keyword">if</span> <span class="var type1" id="S19T4U134">resize</span>, <span class="mxinfo" id="T4:U39"><span class="var type1" id="S19T4U137"><span class="message error" id="M16F612C">resize</span></span></span> = <span class="mxinfo" id="T7:U40">size(<span class="var type1" id="S4T51U140">xx</span>)</span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,72" id="srcline72"> 72</a></span><span class="line">   <span class="mxinfo" id="T51:U42"><span class="var type1" id="S4T51U143">xx</span> = <span class="mxinfo" id="T51:U44"><span class="var type1" id="S4T51U145">xx</span>(:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,73" id="srcline73"> 73</a></span><span class="line">   <span class="mxinfo" id="T51:U46"><span class="var type1" id="S2T51U149">b</span> = <span class="mxinfo" id="T51:U48"><span class="mxinfo" id="T2:U49">NaN</span>*<span class="mxinfo" id="T51:U50">ones(<span class="mxinfo" id="T2:U51">length(<span class="var type1" id="S4T51U157">xx</span>)</span>,<span class="var type1" id="S14T2U158">nb</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,74" id="srcline74"> 74</a></span><span class="line">   <span class="mxinfo" id="T2:U54"><span class="var type1" id="S3T2U161">alpha</span> = <span class="mxinfo" id="T2:U56"><span class="var type1" id="S3T2U164">alpha</span>(1) - <span class="var type1" id="S12T2U166">nfirst</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%  Asymptotic expansion for large x.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,78" id="srcline78"> 78</a></span><span class="line">   <span class="mxinfo" id="T51:U59"><span class="var type1" id="S23T51U169">v</span> = <span class="mxinfo" id="T51:U61">find(<span class="mxinfo" id="T50:U62"><span class="mxinfo" id="T2:U63">1.e3</span> &lt; <span class="var type1" id="S4T51U174">xx</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,79" id="srcline79"> 79</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T4:U65">any(<span class="var type1" id="S23T51U179">v</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,80" id="srcline80"> 80</a></span><span class="line">      <span class="mxinfo" id="T51:U67"><span class="var type1" id="S25T51U182">x</span> = <span class="mxinfo" id="T51:U69"><span class="var type1" id="S4T51U184">xx</span>(<span class="var type1" id="S23T51U185">v</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,81" id="srcline81"> 81</a></span><span class="line">      <span class="keyword">if</span> <span class="var type1" id="S5T2U188">scale</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,82" id="srcline82"> 82</a></span><span class="line">         <span class="var type0" id="S26T0U191">z</span> = 1./(8*<span class="var type0" id="S25T0U197">x</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,83" id="srcline83"> 83</a></span><span class="line">         <span class="var type0" id="S27T0U200">mu</span> = 4*(<span class="var type0" id="S12T0U208">nfirst</span>+<span class="var type0" id="S3T0U209">alpha</span>:1:<span class="var type0" id="S14T0U213">nb</span>-1+<span class="var type0" id="S3T0U215">alpha</span>).^2;</span></span>
<span class="srcline"><span class="lineno"><a href="131,84" id="srcline84"> 84</a></span><span class="line">         <span class="var type0" id="S26T0U219">z</span> = (1 - <span class="var type0" id="S26T0U225">z</span>*(<span class="var type0" id="S27T0U228">mu</span>-1).*(1 - (<span class="var type0" id="S26T0U237">z</span>/2)*(<span class="var type0" id="S27T0U241">mu</span>-9).*(1 - (<span class="var type0" id="S26T0U249">z</span>/3)*(<span class="var type0" id="S27T0U253">mu</span> - 25))));</span></span>
<span class="srcline"><span class="lineno"><a href="131,85" id="srcline85"> 85</a></span><span class="line">         <span class="var type0" id="S2T0U258">b</span>(<span class="var type0" id="S23T0U259">v</span>,<span class="var type0" id="S12T0U262">nfirst</span>+1:<span class="var type0" id="S14T0U264">nb</span>) = ((1./sqrt(2*pi*<span class="var type0" id="S25T0U278">x</span>))*ones(1,<span class="var type0" id="S14T0U283">nb</span>-<span class="var type0" id="S12T0U284">nfirst</span>)).*<span class="var type0" id="S26T0U285">z</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,86" id="srcline86"> 86</a></span><span class="line">      <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,87" id="srcline87"> 87</a></span><span class="line">         <span class="mxinfo" id="T51:U73"><span class="mxinfo" id="T51:U74"><span class="var type1" id="S2T51U290">b</span>(<span class="var type1" id="S23T51U291">v</span>,:)</span> = <span class="mxinfo" id="T51:U77"><span class="mxinfo" id="T2:U78">Inf</span>*<span class="mxinfo" id="T51:U79">ones(<span class="mxinfo" id="T2:U80">length(<span class="var type1" id="S23T51U300">v</span>)</span>,<span class="var type1" id="S14T2U301">nb</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,88" id="srcline88"> 88</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,89" id="srcline89"> 89</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">%  Three-term backward recurrence for most x.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,93" id="srcline93"> 93</a></span><span class="line">   <span class="mxinfo" id="T51:U83"><span class="var type1" id="S23T51U304">v</span> = <span class="mxinfo" id="T51:U85">find(<span class="mxinfo" id="T50:U86">(<span class="mxinfo" id="T50:U87"><span class="mxinfo" id="T2:U88">1.e-4</span> &lt;= <span class="var type1" id="S4T51U311">xx</span></span>) &amp; (<span class="mxinfo" id="T50:U90"><span class="var type1" id="S4T51U314">xx</span> &lt;= <span class="mxinfo" id="T2:U92">1.e3</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,94" id="srcline94"> 94</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T4:U93">any(<span class="var type1" id="S23T51U320">v</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,95" id="srcline95"> 95</a></span><span class="line">      <span class="mxinfo" id="T51:U95"><span class="var type1" id="S25T51U323">x</span> = <span class="mxinfo" id="T51:U97"><span class="var type1" id="S4T51U325">xx</span>(<span class="var type1" id="S23T51U326">v</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,96" id="srcline96"> 96</a></span><span class="line">      <span class="mxinfo" id="T2:U100"><span class="var type1" id="S31T2U329">magx</span> = <span class="mxinfo" id="T2:U102">max(<span class="mxinfo" id="T51:U103">fix(<span class="var type1" id="S25T51U334">x</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,97" id="srcline97"> 97</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,98" id="srcline98"> 98</a></span><span class="line"><span class="comment">%     Initialize the forward sweep, the p-sequence of Olver.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,100" id="srcline100">100</a></span><span class="line">      <span class="mxinfo" id="T2:U105"><span class="var type1" id="S33T2U337">nbmx</span> = <span class="mxinfo" id="T2:U107"><span class="var type1" id="S14T2U339">nb</span>-<span class="var type1" id="S31T2U340">magx</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,101" id="srcline101">101</a></span><span class="line">      <span class="mxinfo" id="T2:U110"><span class="var type1" id="S34T2U343">n</span> = <span class="mxinfo" id="T2:U112"><span class="var type1" id="S31T2U345">magx</span>+<span class="mxinfo" id="T2:U114">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,102" id="srcline102">102</a></span><span class="line">      <span class="mxinfo" id="T2:U115"><span class="var type1" id="S35T2U349">en</span> = <span class="mxinfo" id="T2:U117">(<span class="mxinfo" id="T2:U118"><span class="var type1" id="S34T2U353">n</span>+<span class="var type1" id="S34T2U354">n</span></span>) + (<span class="mxinfo" id="T2:U121"><span class="var type1" id="S3T2U357">alpha</span>+<span class="var type1" id="S3T2U358">alpha</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,103" id="srcline103">103</a></span><span class="line">      <span class="mxinfo" id="T2:U124"><span class="var type1" id="S36T2U361">plast</span> = <span class="mxinfo" id="T2:U126">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,104" id="srcline104">104</a></span><span class="line">      <span class="mxinfo" id="T51:U127"><span class="var type1" id="S37T51U365">p</span> = <span class="mxinfo" id="T51:U129"><span class="var type1" id="S35T2U367">en</span> ./ <span class="var type1" id="S25T51U368">x</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,105" id="srcline105">105</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,106" id="srcline106">106</a></span><span class="line"><span class="comment">%     Calculate general significance test.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,107" id="srcline107">107</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,108" id="srcline108">108</a></span><span class="line">      <span class="mxinfo" id="T2:U132"><span class="var type1" id="S38T2U371">test</span> = <span class="mxinfo" id="T2:U134">2/eps</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,109" id="srcline109">109</a></span><span class="line">      <span class="keyword">if</span> (<span class="mxinfo" id="T4:U135"><span class="mxinfo" id="T2:U136"><span class="mxinfo" id="T2:U137">2</span>*<span class="var type1" id="S31T2U382">magx</span></span> &gt; <span class="mxinfo" id="T2:U139">80</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,110" id="srcline110">110</a></span><span class="line">         <span class="mxinfo" id="T2:U140"><span class="var type1" id="S38T2U386">test</span> = <span class="mxinfo" id="T2:U142">sqrt(<span class="mxinfo" id="T2:U143"><span class="mxinfo" id="T2:U144"><span class="var type1" id="S38T2U390">test</span></span>*<span class="mxinfo" id="T2:U146">max(<span class="var type1" id="S37T51U393">p</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,111" id="srcline111">111</a></span><span class="line">      <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,112" id="srcline112">112</a></span><span class="line">         <span class="mxinfo" id="T2:U148"><span class="var type1" id="S38T2U397">test</span> = <span class="mxinfo" id="T2:U150"><span class="mxinfo" id="T2:U151"><span class="var type1" id="S38T2U399">test</span></span> / <span class="mxinfo" id="T2:U153"><span class="mxinfo" id="T2:U154">1.585</span>^<span class="var type1" id="S31T2U402">magx</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,113" id="srcline113">113</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,114" id="srcline114">114</a></span><span class="line">      <span class="keyword">if</span> (<span class="mxinfo" id="T4:U156"><span class="var type1" id="S33T2U407">nbmx</span> &gt;= <span class="mxinfo" id="T2:U158">3</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,115" id="srcline115">115</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,116" id="srcline116">116</a></span><span class="line"><span class="comment">%     Calculate p-sequence until n = nb-1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,117" id="srcline117">117</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,118" id="srcline118">118</a></span><span class="line">         <span class="mxinfo" id="T2:U159"><span class="var type1" id="S39T2U411">tover</span> = <span class="mxinfo" id="T2:U161"><span class="mxinfo" id="T2:U162">eps</span>*<span class="mxinfo" id="T2:U163">realmax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,119" id="srcline119">119</a></span><span class="line">         <span class="mxinfo" id="T2:U164"><span class="var type1" id="S41T2U419">nstart</span> = <span class="mxinfo" id="T2:U166"><span class="var type1" id="S31T2U421">magx</span>+<span class="mxinfo" id="T2:U168">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,120" id="srcline120">120</a></span><span class="line">         <span class="mxinfo" id="T2:U169"><span class="var type1" id="S42T2U425">nend</span> = <span class="mxinfo" id="T2:U171"><span class="var type1" id="S14T2U427">nb</span> - 1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,121" id="srcline121">121</a></span><span class="line">         <span class="keyword">for</span> <span class="var type1" id="S43T2U431">k</span> = <span class="mxinfo" id="T51:U174"><span class="var type1" id="S41T2U433">nstart</span>:<span class="mxinfo" id="T2:U176"><span class="var type1" id="S42T2U434">nend</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,122" id="srcline122">122</a></span><span class="line">            <span class="mxinfo" id="T2:U178"><span class="var type1" id="S34T2U437">n</span> = <span class="var type1" id="S43T2U438">k</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,123" id="srcline123">123</a></span><span class="line">            <span class="mxinfo" id="T2:U181"><span class="var type1" id="S35T2U441">en</span> = <span class="mxinfo" id="T2:U183"><span class="var type1" id="S35T2U443">en</span> + <span class="mxinfo" id="T2:U185">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,124" id="srcline124">124</a></span><span class="line">            <span class="mxinfo" id="T2:U186"><span class="var type1" id="S44T2U447">pold</span> = <span class="var type1" id="S36T2U448">plast</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,125" id="srcline125">125</a></span><span class="line">            <span class="mxinfo" id="T2:U189"><span class="var type1" id="S36T2U451"><span class="message error" id="M17F612C">plast</span></span></span> = <span class="var type1" id="S37T51U452">p</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,126" id="srcline126">126</a></span><span class="line">            <span class="mxinfo" id="T51:U191"><span class="var type1" id="S37T51U455">p</span> = <span class="mxinfo" id="T51:U193"><span class="mxinfo" id="T51:U194"><span class="mxinfo" id="T2:U195"><span class="var type1" id="S35T2U459">en</span> * <span class="var type1" id="S36T2U460">plast</span></span>./<span class="var type1" id="S25T51U461">x</span></span> + <span class="var type1" id="S44T2U462">pold</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,127" id="srcline127">127</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo" id="T4:U200">any(<span class="mxinfo" id="T50:U201"><span class="var type1" id="S37T51U468">p</span> &gt; <span class="var type1" id="S39T2U469">tover</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,128" id="srcline128">128</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,129" id="srcline129">129</a></span><span class="line"><span class="comment">%           To avoid overflow, divide p-sequence by tover.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,130" id="srcline130">130</a></span><span class="line"><span class="comment">%           Calculate p-sequence until abs(p) &gt; 1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,131" id="srcline131">131</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,132" id="srcline132">132</a></span><span class="line">               <span class="mxinfo" id="T2:U204"><span class="var type1" id="S39T2U472">tover</span> = <span class="mxinfo" id="T2:U206">realmax</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,133" id="srcline133">133</a></span><span class="line">               <span class="mxinfo" id="T51:U207"><span class="var type1" id="S37T51U477">p</span> = <span class="mxinfo" id="T51:U209"><span class="var type1" id="S37T51U479">p</span> / <span class="mxinfo" id="T2:U211"><span class="var type1" id="S39T2U480">tover</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,134" id="srcline134">134</a></span><span class="line">               <span class="mxinfo" id="T2:U213"><span class="var type1" id="S36T2U483">plast</span> = <span class="mxinfo" id="T2:U215"><span class="var type1" id="S36T2U485">plast</span> / <span class="mxinfo" id="T2:U217"><span class="var type1" id="S39T2U486">tover</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,135" id="srcline135">135</a></span><span class="line">               <span class="mxinfo" id="T51:U219"><span class="var type1" id="S45T51U489">psave</span> = <span class="var type1" id="S37T51U490">p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,136" id="srcline136">136</a></span><span class="line">               <span class="mxinfo" id="T2:U222"><span class="var type1" id="S46T2U493">psavel</span> = <span class="var type1" id="S36T2U494">plast</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,137" id="srcline137">137</a></span><span class="line">               <span class="mxinfo" id="T2:U225"><span class="var type1" id="S41T2U497">nstart</span> = <span class="mxinfo" id="T2:U227"><span class="var type1" id="S34T2U499">n</span> + <span class="mxinfo" id="T2:U229">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,138" id="srcline138">138</a></span><span class="line">               <span class="keyword">while</span> <span class="mxinfo" id="T4:U230">any(<span class="mxinfo" id="T50:U231"><span class="var type1" id="S37T51U505">p</span> &lt;= <span class="mxinfo" id="T2:U233">1</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,139" id="srcline139">139</a></span><span class="line">                  <span class="mxinfo" id="T2:U234"><span class="var type1" id="S34T2U509">n</span> = <span class="mxinfo" id="T2:U236"><span class="var type1" id="S34T2U511">n</span> + <span class="mxinfo" id="T2:U238">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,140" id="srcline140">140</a></span><span class="line">                  <span class="mxinfo" id="T2:U239"><span class="var type1" id="S35T2U515">en</span> = <span class="mxinfo" id="T2:U241"><span class="var type1" id="S35T2U517">en</span> + <span class="mxinfo" id="T2:U243">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,141" id="srcline141">141</a></span><span class="line">                  <span class="mxinfo" id="T2:U244"><span class="var type1" id="S44T2U521">pold</span> = <span class="var type1" id="S36T2U522">plast</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,142" id="srcline142">142</a></span><span class="line">                  <span class="mxinfo" id="T2:U247"><span class="var type1" id="S36T2U525"><span class="message error" id="M18F612C">plast</span></span></span> = <span class="var type1" id="S37T51U526">p</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,143" id="srcline143">143</a></span><span class="line">                  <span class="mxinfo" id="T51:U249"><span class="var type1" id="S37T51U529">p</span> = <span class="mxinfo" id="T51:U251"><span class="mxinfo" id="T51:U252"><span class="mxinfo" id="T2:U253"><span class="var type1" id="S35T2U533">en</span> * <span class="var type1" id="S36T2U534">plast</span></span>./<span class="var type1" id="S25T51U535">x</span></span> + <span class="var type1" id="S44T2U536">pold</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,144" id="srcline144">144</a></span><span class="line">               <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,145" id="srcline145">145</a></span><span class="line">               <span class="mxinfo" id="T51:U258"><span class="var type1" id="S47T51U539">tempb</span> = <span class="mxinfo" id="T51:U260"><span class="var type1" id="S35T2U541">en</span> ./ <span class="var type1" id="S25T51U542">x</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,146" id="srcline146">146</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,147" id="srcline147">147</a></span><span class="line"><span class="comment">%              Calculate backward test, and find ncalc,</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,148" id="srcline148">148</a></span><span class="line"><span class="comment">%              the highest n such that the test is passed.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,149" id="srcline149">149</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,150" id="srcline150">150</a></span><span class="line">               <span class="mxinfo" id="T2:U263"><span class="var type1" id="S38T2U545">test</span> = <span class="mxinfo" id="T2:U265"><span class="mxinfo" id="T2:U266"><span class="var type1" id="S44T2U548">pold</span>*<span class="var type1" id="S36T2U549">plast</span></span>*<span class="mxinfo" id="T2:U269">eps</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,151" id="srcline151">151</a></span><span class="line">               <span class="mxinfo" id="T2:U270"><span class="var type1" id="S38T2U554">test</span> = <span class="mxinfo" id="T2:U272"><span class="var type1" id="S38T2U556">test</span>*(<span class="mxinfo" id="T2:U274"><span class="mxinfo" id="T2:U275">0.5</span>-<span class="mxinfo" id="T2:U276"><span class="mxinfo" id="T2:U277">0.5</span>/<span class="mxinfo" id="T2:U278">min(<span class="mxinfo" id="T51:U279"><span class="var type1" id="S47T51U565">tempb</span>*<span class="var type1" id="S47T51U566">tempb</span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,152" id="srcline152">152</a></span><span class="line">               <span class="mxinfo" id="T51:U282"><span class="var type1" id="S37T51U569">p</span> = <span class="mxinfo" id="T2:U284"><span class="var type1" id="S36T2U571">plast</span> * <span class="mxinfo" id="T2:U286"><span class="var type1" id="S39T2U572">tover</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,153" id="srcline153">153</a></span><span class="line">               <span class="mxinfo" id="T2:U288"><span class="var type1" id="S34T2U575">n</span> = <span class="mxinfo" id="T2:U290"><span class="var type1" id="S34T2U577">n</span> - <span class="mxinfo" id="T2:U292">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,154" id="srcline154">154</a></span><span class="line">               <span class="mxinfo" id="T2:U293"><span class="var type1" id="S35T2U581">en</span> = <span class="mxinfo" id="T2:U295"><span class="var type1" id="S35T2U583">en</span> - <span class="mxinfo" id="T2:U297">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,155" id="srcline155">155</a></span><span class="line">               <span class="mxinfo" id="T2:U298"><span class="var type1" id="S42T2U587">nend</span> = <span class="mxinfo" id="T2:U300">min(<span class="mxinfo" id="T2:U301"><span class="var type1" id="S14T2U590">nb</span></span>,<span class="var type1" id="S34T2U591">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,156" id="srcline156">156</a></span><span class="line">               <span class="mxinfo" id="T2:U304"><span class="var type1" id="S49T2U594">ncalc</span> = <span class="mxinfo" id="T2:U306"><span class="var type1" id="S42T2U596">nend</span> + <span class="mxinfo" id="T2:U308">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,157" id="srcline157">157</a></span><span class="line">               <span class="keyword">for</span> <span class="var type1" id="S50T2U600">l</span> = <span class="mxinfo" id="T51:U310"><span class="var type1" id="S41T2U602">nstart</span>:<span class="var type1" id="S42T2U603">nend</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,158" id="srcline158">158</a></span><span class="line">                  <span class="mxinfo" id="T2:U313"><span class="var type1" id="S44T2U606">pold</span> = <span class="var type1" id="S46T2U607">psavel</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,159" id="srcline159">159</a></span><span class="line">                  <span class="mxinfo" id="T2:U316"><span class="var type1" id="S46T2U610"><span class="message error" id="M19F612C">psavel</span></span></span> = <span class="var type1" id="S45T51U611">psave</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,160" id="srcline160">160</a></span><span class="line">                  <span class="mxinfo" id="T51:U318"><span class="var type1" id="S45T51U614">psave</span> = <span class="mxinfo" id="T51:U320"><span class="mxinfo" id="T51:U321"><span class="mxinfo" id="T2:U322"><span class="var type1" id="S35T2U618">en</span> * <span class="var type1" id="S46T2U619">psavel</span></span>./<span class="var type1" id="S25T51U620">x</span></span> + <span class="var type1" id="S44T2U621">pold</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,161" id="srcline161">161</a></span><span class="line">                  <span class="keyword">if</span> <span class="mxinfo" id="T4:U327">any(<span class="mxinfo" id="T50:U328"><span class="mxinfo" id="T51:U329"><span class="var type1" id="S45T51U628">psave</span>.*<span class="var type1" id="S46T2U629">psavel</span></span> &gt; <span class="var type1" id="S38T2U630">test</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,162" id="srcline162">162</a></span><span class="line">                     <span class="mxinfo" id="T2:U333"><span class="var type1" id="S49T2U633">ncalc</span> = <span class="mxinfo" id="T2:U335"><span class="var type1" id="S50T2U635">l</span>-<span class="mxinfo" id="T2:U337">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,163" id="srcline163">163</a></span><span class="line">                     <span class="mxinfo" id="T2:U338"><span class="var type1" id="S38T2U639">test</span> = <span class="mxinfo" id="T2:U340">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,164" id="srcline164">164</a></span><span class="line">                     <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,165" id="srcline165">165</a></span><span class="line">                  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,166" id="srcline166">166</a></span><span class="line">               <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,167" id="srcline167">167</a></span><span class="line">               <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,168" id="srcline168">168</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,169" id="srcline169">169</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,170" id="srcline170">170</a></span><span class="line">         <span class="keyword">if</span> <span class="mxinfo" id="T4:U341">~<span class="var type1" id="S38T2U646">test</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,171" id="srcline171">171</a></span><span class="line">            <span class="mxinfo" id="T2:U343"><span class="var type1" id="S34T2U649">n</span> = <span class="var type1" id="S42T2U650">nend</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,172" id="srcline172">172</a></span><span class="line">            <span class="mxinfo" id="T2:U346"><span class="var type1" id="S35T2U653">en</span> = <span class="mxinfo" id="T2:U348">(<span class="mxinfo" id="T2:U349"><span class="var type1" id="S34T2U657">n</span>+<span class="var type1" id="S34T2U658">n</span></span>) + (<span class="mxinfo" id="T2:U352"><span class="var type1" id="S3T2U661">alpha</span>+<span class="var type1" id="S3T2U662">alpha</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,173" id="srcline173">173</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,174" id="srcline174">174</a></span><span class="line"><span class="comment">%           Calculate special significance test for nbmx &gt; 2.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,175" id="srcline175">175</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,176" id="srcline176">176</a></span><span class="line">            <span class="mxinfo" id="T2:U355"><span class="var type1" id="S38T2U665">test</span> = <span class="mxinfo" id="T2:U357">max(<span class="var type1" id="S38T2U668">test</span>,<span class="mxinfo" id="T2:U359">max(<span class="mxinfo" id="T51:U360"><span class="mxinfo" id="T2:U361">sqrt(<span class="mxinfo" id="T2:U362"><span class="var type1" id="S36T2U675">plast</span>/<span class="mxinfo" id="T2:U364">eps</span></span>)</span>.*<span class="mxinfo" id="T51:U365">sqrt(<span class="mxinfo" id="T51:U366"><span class="var type1" id="S37T51U681">p</span>+<span class="var type1" id="S37T51U682">p</span></span>)</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,177" id="srcline177">177</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,178" id="srcline178">178</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,179" id="srcline179">179</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,180" id="srcline180">180</a></span><span class="line"><span class="comment">%     Calculate p-sequence until significance test passed.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,181" id="srcline181">181</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,182" id="srcline182">182</a></span><span class="line">      <span class="keyword">while</span> <span class="mxinfo" id="T4:U369">any(<span class="mxinfo" id="T50:U370"><span class="var type1" id="S37T51U687">p</span> &lt; <span class="var type1" id="S38T2U688">test</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,183" id="srcline183">183</a></span><span class="line">         <span class="mxinfo" id="T2:U373"><span class="var type1" id="S34T2U691">n</span> = <span class="mxinfo" id="T2:U375"><span class="var type1" id="S34T2U693">n</span> + <span class="mxinfo" id="T2:U377">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,184" id="srcline184">184</a></span><span class="line">         <span class="mxinfo" id="T2:U378"><span class="var type1" id="S35T2U697">en</span> = <span class="mxinfo" id="T2:U380"><span class="var type1" id="S35T2U699">en</span> + <span class="mxinfo" id="T2:U382">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,185" id="srcline185">185</a></span><span class="line">         <span class="mxinfo" id="T2:U383"><span class="var type1" id="S44T2U703">pold</span> = <span class="var type1" id="S36T2U704">plast</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,186" id="srcline186">186</a></span><span class="line">         <span class="mxinfo" id="T2:U386"><span class="var type1" id="S36T2U707"><span class="message error" id="M20F612C">plast</span></span></span> = <span class="var type1" id="S37T51U708">p</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,187" id="srcline187">187</a></span><span class="line">         <span class="mxinfo" id="T51:U388"><span class="var type1" id="S37T51U711">p</span> = <span class="mxinfo" id="T51:U390"><span class="mxinfo" id="T51:U391"><span class="mxinfo" id="T2:U392"><span class="var type1" id="S35T2U715">en</span> * <span class="var type1" id="S36T2U716">plast</span></span>./<span class="var type1" id="S25T51U717">x</span></span> + <span class="var type1" id="S44T2U718">pold</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,188" id="srcline188">188</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,189" id="srcline189">189</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,190" id="srcline190">190</a></span><span class="line"><span class="comment">%     Initialize the backward recursion and the normalization sum.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,191" id="srcline191">191</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,192" id="srcline192">192</a></span><span class="line">      <span class="mxinfo" id="T2:U397"><span class="var type1" id="S34T2U721">n</span> = <span class="mxinfo" id="T2:U399"><span class="var type1" id="S34T2U723">n</span> + <span class="mxinfo" id="T2:U401">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,193" id="srcline193">193</a></span><span class="line">      <span class="mxinfo" id="T2:U402"><span class="var type1" id="S35T2U727">en</span> = <span class="mxinfo" id="T2:U404"><span class="var type1" id="S35T2U729">en</span> + <span class="mxinfo" id="T2:U406">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,194" id="srcline194">194</a></span><span class="line">      <span class="mxinfo" id="T2:U407"><span class="var type1" id="S47T2U733">tempb</span> = <span class="mxinfo" id="T2:U409">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,195" id="srcline195">195</a></span><span class="line">      <span class="mxinfo" id="T51:U410"><span class="var type1" id="S51T51U737">tempa</span> = <span class="mxinfo" id="T51:U412"><span class="mxinfo" id="T2:U413">1</span> ./ <span class="var type1" id="S37T51U740">p</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,196" id="srcline196">196</a></span><span class="line">      <span class="mxinfo" id="T2:U415"><span class="var type1" id="S52T2U743">em</span> = <span class="mxinfo" id="T2:U417"><span class="var type1" id="S34T2U745">n</span> - <span class="mxinfo" id="T2:U419">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,197" id="srcline197">197</a></span><span class="line">      <span class="mxinfo" id="T2:U420"><span class="var type1" id="S53T2U749">empal</span> = <span class="mxinfo" id="T2:U422"><span class="var type1" id="S52T2U751">em</span> + <span class="var type1" id="S3T2U752">alpha</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,198" id="srcline198">198</a></span><span class="line">      <span class="mxinfo" id="T2:U425"><span class="var type1" id="S54T2U755">emp2al</span> = <span class="mxinfo" id="T2:U427">(<span class="mxinfo" id="T2:U428"><span class="var type1" id="S52T2U759">em</span> - <span class="mxinfo" id="T2:U430">1</span></span>) + (<span class="mxinfo" id="T2:U431"><span class="var type1" id="S3T2U763">alpha</span> + <span class="var type1" id="S3T2U764">alpha</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,199" id="srcline199">199</a></span><span class="line">      <span class="mxinfo" id="T51:U434"><span class="var type1" id="S55T51U767">sum</span> = <span class="mxinfo" id="T51:U436"><span class="mxinfo" id="T51:U437"><span class="mxinfo" id="T51:U438"><span class="var type1" id="S51T51U771">tempa</span> * <span class="var type1" id="S53T2U772">empal</span></span> * <span class="var type1" id="S54T2U773">emp2al</span></span> / <span class="var type1" id="S52T2U774">em</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,200" id="srcline200">200</a></span><span class="line">      <span class="mxinfo" id="T2:U443"><span class="var type1" id="S42T2U777">nend</span> = <span class="mxinfo" id="T2:U445"><span class="var type1" id="S34T2U779">n</span> - <span class="var type1" id="S14T2U780">nb</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,201" id="srcline201">201</a></span><span class="line">      <span class="mxinfo" id="T2:U448"><span class="var type1" id="S56T2U783">skip</span> = <span class="mxinfo" id="T2:U450">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,202" id="srcline202">202</a></span><span class="line">      <span class="keyword">if</span> (<span class="mxinfo" id="T4:U451"><span class="var type1" id="S42T2U789">nend</span> &lt; <span class="mxinfo" id="T2:U453">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,203" id="srcline203">203</a></span><span class="line">         <span class="mxinfo" id="T51:U454"><span class="mxinfo" id="T51:U455"><span class="var type1" id="S2T51U794">b</span>(<span class="var type1" id="S23T51U795">v</span>,<span class="var type1" id="S34T2U796">n</span>)</span> = <span class="var type1" id="S51T51U797">tempa</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,204" id="srcline204">204</a></span><span class="line">         <span class="mxinfo" id="T2:U460"><span class="var type1" id="S42T2U800">nend</span> = <span class="mxinfo" id="T2:U462">-<span class="var type1" id="S42T2U802">nend</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,205" id="srcline205">205</a></span><span class="line">         <span class="mxinfo" id="T68:U464"><span class="mxinfo" id="T68:U465"><span class="var type1" id="S2T51U806">b</span>(<span class="var type1" id="S23T51U807">v</span>,<span class="mxinfo" id="T51:U468"><span class="mxinfo" id="T2:U469"><span class="var type1" id="S34T2U810">n</span>+1</span>:<span class="mxinfo" id="T2:U471"><span class="var type1" id="S34T2U813">n</span>+<span class="var type1" id="S42T2U814">nend</span></span></span>)</span> = <span class="mxinfo" id="T68:U474">zeros(<span class="mxinfo" id="T2:U475">length(<span class="var type1" id="S23T51U819">v</span>)</span>,<span class="var type1" id="S42T2U820">nend</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,206" id="srcline206">206</a></span><span class="line">      <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,207" id="srcline207">207</a></span><span class="line">         <span class="keyword">if</span> (<span class="mxinfo" id="T4:U478"><span class="var type1" id="S42T2U826">nend</span> &gt; <span class="mxinfo" id="T2:U480">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,208" id="srcline208">208</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,209" id="srcline209">209</a></span><span class="line"><span class="comment">%           Recur backward via difference equation, calculating </span></span></span>
<span class="srcline"><span class="lineno"><a href="131,210" id="srcline210">210</a></span><span class="line"><span class="comment">%           (but not storing) b(n), until n = nb.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,211" id="srcline211">211</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,212" id="srcline212">212</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S50T2U830">l</span> = <span class="mxinfo" id="T51:U482"><span class="mxinfo" id="T2:U483">1</span>:<span class="var type1" id="S42T2U833">nend</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,213" id="srcline213">213</a></span><span class="line">               <span class="mxinfo" id="T2:U485"><span class="var type1" id="S34T2U836">n</span> = <span class="mxinfo" id="T2:U487"><span class="var type1" id="S34T2U838">n</span> - <span class="mxinfo" id="T2:U489">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,214" id="srcline214">214</a></span><span class="line">               <span class="mxinfo" id="T2:U490"><span class="var type1" id="S35T2U842">en</span> = <span class="mxinfo" id="T2:U492"><span class="var type1" id="S35T2U844">en</span> - <span class="mxinfo" id="T2:U494">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,215" id="srcline215">215</a></span><span class="line">               <span class="mxinfo" id="T2:U495"><span class="var type1" id="S58T2U848">tempc</span> = <span class="var type1" id="S47T2U849">tempb</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,216" id="srcline216">216</a></span><span class="line">               <span class="mxinfo" id="T2:U498"><span class="var type1" id="S47T2U852"><span class="message error" id="M21F612C">tempb</span></span></span> = <span class="var type1" id="S51T51U853">tempa</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,217" id="srcline217">217</a></span><span class="line">               <span class="mxinfo" id="T51:U500"><span class="var type1" id="S51T51U856">tempa</span> = <span class="mxinfo" id="T51:U502"><span class="mxinfo" id="T51:U503">(<span class="mxinfo" id="T2:U504"><span class="var type1" id="S35T2U861">en</span>*<span class="var type1" id="S47T2U862">tempb</span></span>) ./ <span class="var type1" id="S25T51U863">x</span></span> + <span class="var type1" id="S58T2U864">tempc</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,218" id="srcline218">218</a></span><span class="line">               <span class="mxinfo" id="T2:U509"><span class="var type1" id="S52T2U867">em</span> = <span class="mxinfo" id="T2:U511"><span class="var type1" id="S52T2U869">em</span> - <span class="mxinfo" id="T2:U513">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,219" id="srcline219">219</a></span><span class="line">               <span class="mxinfo" id="T2:U514"><span class="var type1" id="S54T2U873">emp2al</span> = <span class="mxinfo" id="T2:U516"><span class="var type1" id="S54T2U875">emp2al</span> - <span class="mxinfo" id="T2:U518">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,220" id="srcline220">220</a></span><span class="line">               <span class="keyword">if</span> (<span class="mxinfo" id="T4:U519"><span class="var type1" id="S34T2U881">n</span> == <span class="mxinfo" id="T2:U521">1</span></span>), <span class="keyword">break</span>, <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,221" id="srcline221">221</a></span><span class="line">               <span class="keyword">if</span> (<span class="mxinfo" id="T4:U522"><span class="var type1" id="S34T2U888">n</span> == <span class="mxinfo" id="T2:U524">2</span></span>), <span class="mxinfo" id="T2:U525"><span class="var type1" id="S54T2U892">emp2al</span> = <span class="mxinfo" id="T2:U527">1</span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,222" id="srcline222">222</a></span><span class="line">               <span class="mxinfo" id="T2:U528"><span class="var type1" id="S53T2U896">empal</span> = <span class="mxinfo" id="T2:U530"><span class="var type1" id="S53T2U898">empal</span> - <span class="mxinfo" id="T2:U532">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,223" id="srcline223">223</a></span><span class="line">               <span class="mxinfo" id="T51:U533"><span class="var type1" id="S55T51U902">sum</span> = <span class="mxinfo" id="T51:U535"><span class="mxinfo" id="T51:U536">(<span class="mxinfo" id="T51:U537"><span class="var type1" id="S55T51U907">sum</span> + <span class="mxinfo" id="T51:U539"><span class="var type1" id="S51T51U909">tempa</span>*<span class="var type1" id="S53T2U910">empal</span></span></span>) * <span class="var type1" id="S54T2U911">emp2al</span></span> / <span class="var type1" id="S52T2U912">em</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,224" id="srcline224">224</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,225" id="srcline225">225</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,226" id="srcline226">226</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,227" id="srcline227">227</a></span><span class="line"><span class="comment">%        Store b(nb).</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,228" id="srcline228">228</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,229" id="srcline229">229</a></span><span class="line">         <span class="mxinfo" id="T51:U544"><span class="mxinfo" id="T51:U545"><span class="var type1" id="S2T51U916">b</span>(<span class="var type1" id="S23T51U917">v</span>,<span class="var type1" id="S34T2U918">n</span>)</span> = <span class="var type1" id="S51T51U919">tempa</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,230" id="srcline230">230</a></span><span class="line">         <span class="keyword">if</span> (<span class="var type1" id="S14T2U924">nb</span> &lt;= 1)</span></span>
<span class="srcline"><span class="lineno"><a href="131,231" id="srcline231">231</a></span><span class="line">            <span class="mxinfo" id="T51:U551"><span class="var type1" id="S55T51U928">sum</span> = <span class="mxinfo" id="T51:U553">(<span class="mxinfo" id="T51:U554"><span class="var type1" id="S55T51U932">sum</span> + <span class="var type1" id="S55T51U933">sum</span></span>) + <span class="var type1" id="S51T51U934">tempa</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,232" id="srcline232">232</a></span><span class="line">            <span class="mxinfo" id="T2:U558"><span class="var type1" id="S56T2U937">skip</span> = <span class="mxinfo" id="T2:U560">-<span class="mxinfo" id="T2:U561">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,233" id="srcline233">233</a></span><span class="line">         <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,234" id="srcline234">234</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,235" id="srcline235">235</a></span><span class="line"><span class="comment">%           Calculate and store b(nb-1).</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,236" id="srcline236">236</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,237" id="srcline237">237</a></span><span class="line">            <span class="var type0" id="S34T0U943">n</span> = <span class="var type0" id="S34T0U945">n</span> - 1;</span></span>
<span class="srcline"><span class="lineno"><a href="131,238" id="srcline238">238</a></span><span class="line">            <span class="var type0" id="S35T0U949">en</span> = <span class="var type0" id="S35T0U951">en</span> - 2;</span></span>
<span class="srcline"><span class="lineno"><a href="131,239" id="srcline239">239</a></span><span class="line">            <span class="var type0" id="S2T0U956">b</span>(<span class="var type0" id="S23T0U957">v</span>,<span class="var type0" id="S34T0U958">n</span>)  = (<span class="var type0" id="S35T0U963">en</span>*<span class="var type0" id="S51T0U964">tempa</span>) ./ <span class="var type0" id="S25T0U965">x</span> + <span class="var type0" id="S47T0U966">tempb</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,240" id="srcline240">240</a></span><span class="line">            <span class="keyword">if</span> (<span class="var type0" id="S34T0U971">n</span> == 1)</span></span>
<span class="srcline"><span class="lineno"><a href="131,241" id="srcline241">241</a></span><span class="line">               <span class="var type0" id="S56T0U975">skip</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="131,242" id="srcline242">242</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,243" id="srcline243">243</a></span><span class="line">               <span class="var type0" id="S52T0U980">em</span> = <span class="var type0" id="S52T0U982">em</span> - 1;</span></span>
<span class="srcline"><span class="lineno"><a href="131,244" id="srcline244">244</a></span><span class="line">               <span class="var type0" id="S54T0U986">emp2al</span> = <span class="var type0" id="S54T0U988">emp2al</span> - 1;</span></span>
<span class="srcline"><span class="lineno"><a href="131,245" id="srcline245">245</a></span><span class="line">               <span class="keyword">if</span> (<span class="var type0" id="S34T0U994">n</span> == 2), <span class="var type0" id="S54T0U998">emp2al</span> = 1; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,246" id="srcline246">246</a></span><span class="line">               <span class="var type0" id="S53T0U1002">empal</span> = <span class="var type0" id="S53T0U1004">empal</span> - 1;</span></span>
<span class="srcline"><span class="lineno"><a href="131,247" id="srcline247">247</a></span><span class="line">               <span class="var type0" id="S55T0U1008">sum</span> = (<span class="var type0" id="S55T0U1013">sum</span> + <span class="var type0" id="S2T0U1016">b</span>(<span class="var type0" id="S23T0U1017">v</span>,<span class="var type0" id="S34T0U1018">n</span>)*<span class="var type0" id="S53T0U1019">empal</span>) * <span class="var type0" id="S54T0U1020">emp2al</span> / <span class="var type0" id="S52T0U1021">em</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,248" id="srcline248">248</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,249" id="srcline249">249</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,250" id="srcline250">250</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,251" id="srcline251">251</a></span><span class="line">      <span class="keyword">if</span> <span class="mxinfo" id="T4:U562"><span class="var type1" id="S56T2U1025">skip</span> == <span class="mxinfo" id="T2:U564">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,252" id="srcline252">252</a></span><span class="line">         <span class="mxinfo" id="T2:U565"><span class="var type1" id="S42T2U1029">nend</span> = <span class="mxinfo" id="T2:U567"><span class="var type1" id="S34T2U1031">n</span> - <span class="mxinfo" id="T2:U569">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,253" id="srcline253">253</a></span><span class="line">         <span class="keyword">if</span> (<span class="mxinfo" id="T4:U570"><span class="var type1" id="S42T2U1037">nend</span> &gt; <span class="mxinfo" id="T2:U572">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,254" id="srcline254">254</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,255" id="srcline255">255</a></span><span class="line"><span class="comment">%        Calculate via difference equation and store b(n), until n = 2.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,256" id="srcline256">256</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,257" id="srcline257">257</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S50T2U1041">l</span> = <span class="mxinfo" id="T51:U574"><span class="mxinfo" id="T2:U575">1</span>:<span class="var type1" id="S42T2U1044">nend</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,258" id="srcline258">258</a></span><span class="line">               <span class="mxinfo" id="T2:U577"><span class="var type1" id="S34T2U1047">n</span> = <span class="mxinfo" id="T2:U579"><span class="var type1" id="S34T2U1049">n</span> - <span class="mxinfo" id="T2:U581">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,259" id="srcline259">259</a></span><span class="line">               <span class="mxinfo" id="T2:U582"><span class="var type1" id="S35T2U1053">en</span> = <span class="mxinfo" id="T2:U584"><span class="var type1" id="S35T2U1055">en</span> - <span class="mxinfo" id="T2:U586">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,260" id="srcline260">260</a></span><span class="line">               <span class="mxinfo" id="T51:U587"><span class="mxinfo" id="T51:U588"><span class="var type1" id="S2T51U1060">b</span>(<span class="var type1" id="S23T51U1061">v</span>,<span class="var type1" id="S34T2U1062">n</span>)</span> = <span class="mxinfo" id="T51:U592"><span class="mxinfo" id="T51:U593">(<span class="mxinfo" id="T51:U594"><span class="var type1" id="S35T2U1067">en</span>*<span class="mxinfo" id="T51:U596"><span class="var type1" id="S2T51U1069">b</span>(<span class="var type1" id="S23T51U1070">v</span>,<span class="mxinfo" id="T2:U599"><span class="var type1" id="S34T2U1072">n</span>+<span class="mxinfo" id="T2:U601">1</span></span>)</span></span>) ./ <span class="var type1" id="S25T51U1074">x</span></span> + <span class="mxinfo" id="T51:U603"><span class="var type1" id="S2T51U1076">b</span>(<span class="var type1" id="S23T51U1077">v</span>,<span class="mxinfo" id="T2:U606"><span class="var type1" id="S34T2U1079">n</span>+<span class="mxinfo" id="T2:U608">2</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,261" id="srcline261">261</a></span><span class="line">               <span class="mxinfo" id="T2:U609"><span class="var type1" id="S52T2U1083">em</span> = <span class="mxinfo" id="T2:U611"><span class="var type1" id="S52T2U1085">em</span> - <span class="mxinfo" id="T2:U613">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,262" id="srcline262">262</a></span><span class="line">               <span class="mxinfo" id="T2:U614"><span class="var type1" id="S54T2U1089">emp2al</span> = <span class="mxinfo" id="T2:U616"><span class="var type1" id="S54T2U1091">emp2al</span> - <span class="mxinfo" id="T2:U618">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,263" id="srcline263">263</a></span><span class="line">               <span class="keyword">if</span> (<span class="mxinfo" id="T4:U619"><span class="var type1" id="S34T2U1097">n</span> == <span class="mxinfo" id="T2:U621">2</span></span>), <span class="mxinfo" id="T2:U622"><span class="var type1" id="S54T2U1101">emp2al</span> = <span class="mxinfo" id="T2:U624">1</span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,264" id="srcline264">264</a></span><span class="line">               <span class="mxinfo" id="T2:U625"><span class="var type1" id="S53T2U1105">empal</span> = <span class="mxinfo" id="T2:U627"><span class="var type1" id="S53T2U1107">empal</span> - <span class="mxinfo" id="T2:U629">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,265" id="srcline265">265</a></span><span class="line">               <span class="mxinfo" id="T51:U630"><span class="var type1" id="S55T51U1111">sum</span> = <span class="mxinfo" id="T51:U632"><span class="mxinfo" id="T51:U633">(<span class="mxinfo" id="T51:U634"><span class="var type1" id="S55T51U1116">sum</span> + <span class="mxinfo" id="T51:U636"><span class="mxinfo" id="T51:U637"><span class="var type1" id="S2T51U1119">b</span>(<span class="var type1" id="S23T51U1120">v</span>,<span class="var type1" id="S34T2U1121">n</span>)</span>*<span class="var type1" id="S53T2U1122">empal</span></span></span>) * <span class="var type1" id="S54T2U1123">emp2al</span></span> / <span class="var type1" id="S52T2U1124">em</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,266" id="srcline266">266</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,267" id="srcline267">267</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,268" id="srcline268">268</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,269" id="srcline269">269</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,270" id="srcline270">270</a></span><span class="line"><span class="comment">%     Calculate b(1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,271" id="srcline271">271</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,272" id="srcline272">272</a></span><span class="line">      <span class="keyword">if</span> <span class="mxinfo" id="T4:U644"><span class="var type1" id="S56T2U1128">skip</span> == <span class="mxinfo" id="T2:U646">0</span></span>, <span class="var type0" id="S2T0U1133">b</span>(<span class="var type0" id="S23T0U1134">v</span>,1) = <span class="mxinfo" id="T2:U647"><span class="mxinfo" id="T2:U648">2</span>*<span class="var type1" id="S53T2U1141">empal</span></span>*<span class="var type1" id="S2T51U1143">b</span>(<span class="var type1" id="S23T51U1144">v</span>,<span class="mxinfo" id="T2:U652"><span class="message error" id="M22F612C">2</span></span>) ./ <span class="var type0" id="S25T0U1146">x</span> + <span class="var type0" id="S2T0U1148">b</span>(<span class="var type0" id="S23T0U1149">v</span>,3); <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,273" id="srcline273">273</a></span><span class="line">      <span class="keyword">if</span> <span class="mxinfo" id="T4:U653"><span class="var type1" id="S56T2U1154">skip</span> &gt;= <span class="mxinfo" id="T2:U655">0</span></span>, <span class="mxinfo" id="T51:U656"><span class="var type1" id="S55T51U1158">sum</span> = <span class="mxinfo" id="T51:U658">(<span class="mxinfo" id="T51:U659"><span class="var type1" id="S55T51U1162">sum</span> + <span class="var type1" id="S55T51U1163">sum</span></span>) + <span class="mxinfo" id="T51:U662"><span class="var type1" id="S2T51U1165">b</span>(<span class="var type1" id="S23T51U1166">v</span>,<span class="mxinfo" id="T2:U665">1</span>)</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,274" id="srcline274">274</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,275" id="srcline275">275</a></span><span class="line"><span class="comment">%     Normalize.  Divide all b(n) by sum.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,276" id="srcline276">276</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,277" id="srcline277">277</a></span><span class="line">      <span class="keyword">if</span> (<span class="var type1" id="S3T2U1172">alpha</span> ~= 0)</span></span>
<span class="srcline"><span class="lineno"><a href="131,278" id="srcline278">278</a></span><span class="line">         <span class="var type0" id="S55T0U1176">sum</span> = <span class="var type0" id="S55T0U1179">sum</span> * gamma(1+<span class="var type0" id="S3T0U1184">alpha</span>) .* (<span class="var type0" id="S25T0U1188">x</span>*0.5).^(-<span class="var type0" id="S3T0U1192">alpha</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,279" id="srcline279">279</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,280" id="srcline280">280</a></span><span class="line">      <span class="keyword">if</span> ~<span class="var type1" id="S5T2U1196">scale</span>, <span class="mxinfo" id="T51:U668"><span class="var type1" id="S55T51U1199">sum</span> = <span class="mxinfo" id="T51:U670"><span class="var type1" id="S55T51U1201">sum</span> .* <span class="mxinfo" id="T51:U672">exp(<span class="mxinfo" id="T51:U673">-<span class="var type1" id="S25T51U1205">x</span></span>)</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,281" id="srcline281">281</a></span><span class="line">      <span class="keyword">for</span> <span class="var type1" id="S34T2U1208">n</span> = <span class="mxinfo" id="T2:U676">1:<span class="var type1" id="S14T2U1211">nb</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,282" id="srcline282">282</a></span><span class="line">         <span class="mxinfo" id="T51:U678"><span class="mxinfo" id="T51:U679"><span class="var type1" id="S2T51U1215">b</span>(<span class="var type1" id="S23T51U1216">v</span>,<span class="var type1" id="S34T2U1217">n</span>)</span> = <span class="mxinfo" id="T51:U683"><span class="mxinfo" id="T51:U684"><span class="var type1" id="S2T51U1220">b</span>(<span class="var type1" id="S23T51U1221">v</span>,<span class="mxinfo" id="T2:U687"><span class="var type1" id="S34T2U1222">n</span></span>)</span> ./ <span class="var type1" id="S55T51U1223">sum</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,283" id="srcline283">283</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,284" id="srcline284">284</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,285" id="srcline285">285</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,286" id="srcline286">286</a></span><span class="line"><span class="comment">%  Two-term ascending series for small x.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,287" id="srcline287">287</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,288" id="srcline288">288</a></span><span class="line">   <span class="mxinfo" id="T51:U690"><span class="var type1" id="S23T51U1226">v</span> = <span class="mxinfo" id="T51:U692">find(<span class="mxinfo" id="T50:U693">(<span class="mxinfo" id="T50:U694"><span class="mxinfo" id="T2:U695">0</span> &lt; <span class="var type1" id="S4T51U1233">xx</span></span>) &amp; (<span class="mxinfo" id="T50:U697"><span class="var type1" id="S4T51U1236">xx</span> &lt; <span class="mxinfo" id="T2:U699">1.e-4</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,289" id="srcline289">289</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T4:U700">any(<span class="var type1" id="S23T51U1242">v</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,290" id="srcline290">290</a></span><span class="line">      <span class="mxinfo" id="T51:U702"><span class="var type1" id="S25T51U1245">x</span> = <span class="mxinfo" id="T51:U704"><span class="var type1" id="S4T51U1247">xx</span>(<span class="var type1" id="S23T51U1248">v</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,291" id="srcline291">291</a></span><span class="line">      <span class="mxinfo" id="T51:U707"><span class="var type1" id="S51T51U1251">tempa</span> = <span class="mxinfo" id="T51:U709">ones(<span class="mxinfo" id="T2:U710">length(<span class="var type1" id="S25T51U1256">x</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,292" id="srcline292">292</a></span><span class="line">      <span class="mxinfo" id="T2:U712"><span class="var type1" id="S53T2U1260">empal</span> = <span class="mxinfo" id="T2:U714">1 + <span class="var type1" id="S3T2U1263">alpha</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,293" id="srcline293">293</a></span><span class="line">      <span class="mxinfo" id="T51:U716"><span class="var type1" id="S61T51U1266">halfx</span> = <span class="mxinfo" id="T51:U718"><span class="mxinfo" id="T2:U719">0.5</span> * <span class="var type1" id="S25T51U1269">x</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,294" id="srcline294">294</a></span><span class="line">      <span class="keyword">if</span> (<span class="var type1" id="S3T2U1274">alpha</span> ~= 0),  <span class="var type0" id="S51T0U1278">tempa</span> = <span class="var type0" id="S61T0U1281">halfx</span>.^<span class="var type0" id="S3T0U1282">alpha</span> /gamma(<span class="var type0" id="S53T0U1285">empal</span>); <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,295" id="srcline295">295</a></span><span class="line">      <span class="keyword">if</span> <span class="var type1" id="S5T2U1288">scale</span>, <span class="var type0" id="S51T0U1291">tempa</span> = <span class="var type0" id="S51T0U1293">tempa</span> .* exp(-<span class="var type0" id="S25T0U1297">x</span>); <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,296" id="srcline296">296</a></span><span class="line">      <span class="mxinfo" id="T51:U723"><span class="var type1" id="S47T51U1300">tempb</span> = <span class="mxinfo" id="T51:U725"><span class="var type1" id="S61T51U1302">halfx</span> .* <span class="var type1" id="S61T51U1303">halfx</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,297" id="srcline297">297</a></span><span class="line">      <span class="mxinfo" id="T51:U728"><span class="mxinfo" id="T51:U729"><span class="var type1" id="S2T51U1307">b</span>(<span class="var type1" id="S23T51U1308">v</span>,1)</span> = <span class="mxinfo" id="T51:U732"><span class="var type1" id="S51T51U1311">tempa</span> + <span class="mxinfo" id="T51:U734"><span class="mxinfo" id="T51:U735"><span class="var type1" id="S51T51U1314">tempa</span>.*<span class="var type1" id="S47T51U1315">tempb</span></span> / <span class="mxinfo" id="T2:U738"><span class="var type1" id="S53T2U1316">empal</span></span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,298" id="srcline298">298</a></span><span class="line">      <span class="keyword">if</span> (<span class="var type1" id="S14T2U1321">nb</span> &gt; 1)</span></span>
<span class="srcline"><span class="lineno"><a href="131,299" id="srcline299">299</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,300" id="srcline300">300</a></span><span class="line"><span class="comment">%        Calculate higher-order functions.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,301" id="srcline301">301</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,302" id="srcline302">302</a></span><span class="line">         <span class="var type0" id="S58T0U1325">tempc</span> = <span class="var type0" id="S61T0U1326">halfx</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,303" id="srcline303">303</a></span><span class="line">         <span class="var type0" id="S39T0U1329">tover</span> = 8*realmin ./ <span class="var type0" id="S25T0U1335">x</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,304" id="srcline304">304</a></span><span class="line">         <span class="keyword">for</span> <span class="var type0" id="S34T0U1338">n</span> = 2:<span class="var type0" id="S14T0U1341">nb</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,305" id="srcline305">305</a></span><span class="line">            <span class="var type0" id="S51T0U1344">tempa</span> = <span class="var type0" id="S51T0U1346">tempa</span> / <span class="var type0" id="S53T0U1347">empal</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,306" id="srcline306">306</a></span><span class="line">            <span class="var type0" id="S53T0U1350">empal</span> = <span class="var type0" id="S53T0U1352">empal</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="131,307" id="srcline307">307</a></span><span class="line">            <span class="var type0" id="S51T0U1356">tempa</span> = <span class="var type0" id="S51T0U1358">tempa</span> .* <span class="var type0" id="S58T0U1359">tempc</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,308" id="srcline308">308</a></span><span class="line">            <span class="var type0" id="S51T0U1362">tempa</span> = <span class="var type0" id="S51T0U1364">tempa</span> .* (<span class="var type0" id="S51T0U1367">tempa</span> &gt; <span class="var type0" id="S39T0U1369">tover</span>*<span class="var type0" id="S53T0U1370">empal</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,309" id="srcline309">309</a></span><span class="line">            <span class="var type0" id="S2T0U1374">b</span>(<span class="var type0" id="S23T0U1375">v</span>,<span class="var type0" id="S34T0U1376">n</span>) = <span class="var type0" id="S51T0U1378">tempa</span> + <span class="var type0" id="S51T0U1381">tempa</span>.*<span class="var type0" id="S47T0U1382">tempb</span> / <span class="var type0" id="S53T0U1383">empal</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,310" id="srcline310">310</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,311" id="srcline311">311</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,312" id="srcline312">312</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,313" id="srcline313">313</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,314" id="srcline314">314</a></span><span class="line"><span class="comment">%  x == 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,315" id="srcline315">315</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,316" id="srcline316">316</a></span><span class="line">   <span class="mxinfo" id="T51:U741"><span class="var type1" id="S23T51U1386">v</span> = <span class="mxinfo" id="T51:U743">find(<span class="mxinfo" id="T50:U744"><span class="var type1" id="S4T51U1390">xx</span> == <span class="mxinfo" id="T2:U746">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,317" id="srcline317">317</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T4:U747">any(<span class="var type1" id="S23T51U1396">v</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,318" id="srcline318">318</a></span><span class="line">      <span class="comment">% if alpha&gt;0, I(alpha,0) = 0; I(0,0) = 1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,319" id="srcline319">319</a></span><span class="line">      <span class="mxinfo" id="T51:U749"><span class="mxinfo" id="T51:U750"><span class="var type1" id="S2T51U1400">b</span>(<span class="var type1" id="S23T51U1401">v</span>,:)</span> = <span class="mxinfo" id="T51:U753">zeros(<span class="mxinfo" id="T2:U754">length(<span class="var type1" id="S23T51U1407">v</span>)</span>,<span class="var type1" id="S14T2U1408">nb</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,320" id="srcline320">320</a></span><span class="line">      <span class="keyword">if</span> <span class="var type1" id="S3T2U1412">alpha</span> == 0, <span class="mxinfo" id="T51:U758"><span class="mxinfo" id="T51:U759"><span class="var type1" id="S2T51U1417">b</span>(<span class="var type1" id="S23T51U1418">v</span>,1)</span> = <span class="mxinfo" id="T51:U762">ones(<span class="mxinfo" id="T2:U763">length(<span class="var type1" id="S23T51U1424">v</span>)</span>,1)</span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,321" id="srcline321">321</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,322" id="srcline322">322</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,323" id="srcline323">323</a></span><span class="line"><span class="comment">%  Return the requested index range</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,324" id="srcline324">324</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,325" id="srcline325">325</a></span><span class="line">   <span class="mxinfo" id="T51:U765"><span class="var type1" id="S2T51U1428">b</span> = <span class="mxinfo" id="T51:U767"><span class="var type1" id="S2T51U1430">b</span>(:,<span class="mxinfo" id="T2:U769"><span class="var type1" id="S12T2U1434">nfirst</span>+1:<span class="var type1" id="S14T2U1436">nb</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,326" id="srcline326">326</a></span><span class="line">   <span class="keyword">if</span> <span class="var type1" id="S19T4U1439">resize</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,327" id="srcline327">327</a></span><span class="line">      <span class="var type0" id="S2T0U1442">b</span> = reshape(<span class="var type1" id="S2T51U1445">b</span>,<span class="var type1" id="S19T4U1447">resize</span>(1),<span class="var type1" id="S19T4U1450">resize</span>(<span class="mxinfo" id="T2:U776"><span class="message error" id="M23F612C">2</span></span>));</span></span>
<span class="srcline"><span class="lineno"><a href="131,328" id="srcline328">328</a></span><span class="line">   <span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
