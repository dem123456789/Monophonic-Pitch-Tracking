<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="182,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">out</span>] = Smooth2(<span class="var type1" id="S3T1U6">arr</span>, <span class="var type1" id="S4T4U7">Prm</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,2" id="srcline2">  2</a></span><span class="line"><span class="mxinfo " id="T2:U4"><span class="var type1" id="S5T2U10">min_length</span> = <span class="mxinfo " id="T2:U6"><span class="var type1" id="S4T4U12">Prm</span>.smooth_threshold</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,3" id="srcline3">  3</a></span><span class="line"><span class="mxinfo " id="T2:U8"><span class="var type1" id="S6T2U16">stable_length</span> = <span class="mxinfo " id="T2:U10">50</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,4" id="srcline4">  4</a></span><span class="line"><span class="mxinfo " id="T2:U11"><span class="var type1" id="S7T2U20">absorb_threshold</span> = <span class="mxinfo " id="T2:U13">0.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,5" id="srcline5">  5</a></span><span class="line"><span class="mxinfo " id="T2:U14"><span class="var type1" id="S8T2U24">pivot</span> = <span class="mxinfo " id="T2:U16"><span class="var type1" id="S3T1U26">arr</span>(<span class="mxinfo " id="T2:U18">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,6" id="srcline6">  6</a></span><span class="line"><span class="mxinfo " id="T1:U19"><span class="var type1" id="S9T1U30">headidx</span> = <span class="mxinfo " id="T2:U21">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,7" id="srcline7">  7</a></span><span class="line"><span class="mxinfo " id="T1:U22"><span class="var type1" id="S10T1U34">headpitches</span> = <span class="mxinfo " id="T2:U24"><span class="var type1" id="S3T1U36">arr</span>(<span class="mxinfo " id="T2:U26">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,8" id="srcline8">  8</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T2U40">i</span>=<span class="mxinfo " id="T2:U28">1</span>:length(<span class="var type1" id="S3T1U45">arr</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,9" id="srcline9">  9</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo " id="T11:U30"><span class="mxinfo " id="T2:U31"><span class="var type1" id="S3T1U51">arr</span>(<span class="var type1" id="S11T2U52">i</span>)</span>~=<span class="var type1" id="S8T2U53">pivot</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,10" id="srcline10"> 10</a></span><span class="line">        <span class="mxinfo " id="T1:U35"><span class="var type1" id="S9T1U56">headidx</span> = <span class="mxinfo " id="T1:U37">[<span class="var type1" id="S9T1U59">headidx</span> <span class="var type1" id="S11T2U60">i</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,11" id="srcline11"> 11</a></span><span class="line">        <span class="mxinfo " id="T1:U40"><span class="var type1" id="S10T1U63">headpitches</span> = <span class="mxinfo " id="T1:U42">[<span class="var type1" id="S10T1U66">headpitches</span> <span class="mxinfo " id="T2:U44"><span class="var type1" id="S3T1U68">arr</span>(<span class="var type1" id="S11T2U69">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,12" id="srcline12"> 12</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo " id="T2:U47"><span class="var type1" id="S8T2U72">pivot</span>=<span class="mxinfo " id="T2:U49"><span class="var type1" id="S3T1U74">arr</span>(<span class="var type1" id="S11T2U75">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,14" id="srcline14"> 14</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="182,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%idx = 1:length(arr);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T1:U52"><span class="var type1" id="S13T1U78">prev_headidx</span> = <span class="var type1" id="S9T1U79">headidx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T1:U55"><span class="var type1" id="S14T1U82">tmp_headidx</span> = <span class="mxinfo " id="T1:U57">[<span class="var type1" id="S9T1U85">headidx</span> <span class="mxinfo " id="T2:U59">length(<span class="var type1" id="S3T1U88">arr</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T1:U61"><span class="var type1" id="S15T1U91">pitcheslength</span> = <span class="mxinfo " id="T1:U63">diff(<span class="var type1" id="S14T1U94">tmp_headidx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo " id="T1:U65"><span class="var type1" id="S17T1U97">visited</span> = <span class="mxinfo " id="T1:U67">zeros(<span class="mxinfo " id="T2:U68">1</span>,<span class="mxinfo " id="T2:U69">length(<span class="var type1" id="S15T1U103">pitcheslength</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,21" id="srcline21"> 21</a></span><span class="line"><span class="keyword">while</span>(1)</span></span>
<span class="srcline"><span class="lineno"><a href="182,22" id="srcline22"> 22</a></span><span class="line">    <span class="mxinfo " id="T1:U71"><span class="var type1" id="S14T1U109">tmp_headidx</span> = <span class="mxinfo " id="T1:U73">[<span class="var type1" id="S9T1U112">headidx</span> <span class="mxinfo " id="T2:U75">length(<span class="var type1" id="S3T1U115">arr</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,23" id="srcline23"> 23</a></span><span class="line">    <span class="mxinfo " id="T1:U77"><span class="var type1" id="S15T1U118">pitcheslength</span> = <span class="mxinfo " id="T1:U79">diff(<span class="var type1" id="S14T1U121">tmp_headidx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,24" id="srcline24"> 24</a></span><span class="line">    [<span class="var type1" id="S19T1U125">sorted_pitcheslength</span>,<span class="var type1" id="S20T1U126">sorted_idx</span>]=sort(<span class="var type1" id="S15T1U129">pitcheslength</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="182,25" id="srcline25"> 25</a></span><span class="line">        <span class="keyword">if</span>(<span class="mxinfo " id="T11:U84">all(<span class="mxinfo " id="T6:U85"><span class="var type1" id="S17T1U136">visited</span>==<span class="mxinfo " id="T2:U87">1</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%         if(isequal(prev_headidx,headidx)&amp;&amp; all((diff(tmp_headidx)&gt;min_length | headpitches==0)))</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,27" id="srcline27"> 27</a></span><span class="line">        <span class="keyword">if</span>(<span class="mxinfo " id="T11:U88">isequal(<span class="var type1" id="S13T1U143">prev_headidx</span>,<span class="var type1" id="S9T1U144">headidx</span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,28" id="srcline28"> 28</a></span><span class="line">            <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,29" id="srcline29"> 29</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,30" id="srcline30"> 30</a></span><span class="line">            <span class="mxinfo " id="T1:U91"><span class="var type1" id="S17T1U149">visited</span> = <span class="mxinfo " id="T1:U93">zeros(<span class="mxinfo " id="T2:U94">1</span>,<span class="mxinfo " id="T2:U95">length(<span class="var type1" id="S15T1U155">pitcheslength</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,31" id="srcline31"> 31</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,32" id="srcline32"> 32</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,33" id="srcline33"> 33</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="182,34" id="srcline34"> 34</a></span><span class="line">    <span class="mxinfo " id="T1:U97"><span class="var type1" id="S24T1U158">sorted_pitches</span> = <span class="mxinfo " id="T1:U99"><span class="var type1" id="S10T1U160">headpitches</span>(<span class="var type1" id="S20T1U161">sorted_idx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo " id="T1:U102"><span class="var type1" id="S13T1U164">prev_headidx</span> = <span class="var type1" id="S9T1U165">headidx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,36" id="srcline36"> 36</a></span><span class="line">    <span class="mxinfo " id="T97:U105"><span class="var type1" id="S25T97U168">index</span> = <span class="mxinfo " id="T97:U107">find(<span class="mxinfo " id="T6:U108"><span class="var type1" id="S17T1U172">visited</span>==<span class="mxinfo " id="T2:U110">0</span></span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,37" id="srcline37"> 37</a></span><span class="line">    <span class="mxinfo " id="T97:U111"><span class="mxinfo " id="T97:U112"><span class="var type1" id="S17T1U178">visited</span>(<span class="var type1" id="S25T97U179">index</span>)</span> = <span class="mxinfo " id="T2:U115">1</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="182,38" id="srcline38"> 38</a></span><span class="line">    <span class="comment">%sorted_headidx = headidx(sorted_idx);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="182,40" id="srcline40"> 40</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="182,41" id="srcline41"> 41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="182,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T97:U116"><span class="var type1" id="S27T97U183">check_pitch</span> = <span class="mxinfo " id="T97:U118"><span class="var type1" id="S24T1U185">sorted_pitches</span>(<span class="var type1" id="S25T97U186">index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T97:U121"><span class="var type1" id="S28T97U189">check_pitchlength</span> = <span class="mxinfo " id="T97:U123"><span class="var type1" id="S19T1U191">sorted_pitcheslength</span>(<span class="var type1" id="S25T97U192">index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T97:U126"><span class="var type1" id="S29T97U195">check_idx</span> = <span class="mxinfo " id="T97:U128"><span class="var type1" id="S20T1U197">sorted_idx</span>(<span class="var type1" id="S25T97U198">index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,45" id="srcline45"> 45</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo " id="T11:U131">all(<span class="mxinfo " id="T124:U132"><span class="var type1" id="S29T97U205">check_idx</span>==<span class="mxinfo " id="T2:U134">1</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,46" id="srcline46"> 46</a></span><span class="line">        <span class="mxinfo " id="T97:U135"><span class="var type1" id="S30T97U209">left_pitch</span> = <span class="mxinfo " id="T2:U137">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,47" id="srcline47"> 47</a></span><span class="line">        <span class="mxinfo " id="T97:U138"><span class="var type1" id="S31T97U213">left_pitchlength</span> = <span class="mxinfo " id="T2:U140">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,48" id="srcline48"> 48</a></span><span class="line">        <span class="mxinfo " id="T97:U141"><span class="var type1" id="S32T97U217">right_pitch</span> = <span class="mxinfo " id="T97:U143"><span class="var type1" id="S10T1U219">headpitches</span>(<span class="mxinfo " id="T97:U145"><span class="var type1" id="S29T97U221">check_idx</span>+<span class="mxinfo " id="T2:U147">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,49" id="srcline49"> 49</a></span><span class="line">        <span class="mxinfo " id="T97:U148"><span class="var type1" id="S33T97U225">right_pitchlength</span> = <span class="mxinfo " id="T97:U150"><span class="var type1" id="S15T1U227">pitcheslength</span>(<span class="mxinfo " id="T97:U152"><span class="var type1" id="S29T97U229">check_idx</span>+<span class="mxinfo " id="T2:U154">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,50" id="srcline50"> 50</a></span><span class="line">    <span class="keyword">elseif</span>(<span class="mxinfo " id="T11:U155">all(<span class="mxinfo " id="T124:U156"><span class="var type1" id="S29T97U236">check_idx</span>==<span class="mxinfo " id="T2:U158">length(<span class="var type1" id="S9T1U239">headidx</span>)</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,51" id="srcline51"> 51</a></span><span class="line">        <span class="mxinfo " id="T97:U160"><span class="var type1" id="S30T97U242">left_pitch</span> = <span class="mxinfo " id="T97:U162"><span class="var type1" id="S10T1U244">headpitches</span>(<span class="mxinfo " id="T97:U164"><span class="var type1" id="S29T97U246">check_idx</span>-<span class="mxinfo " id="T2:U166">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,52" id="srcline52"> 52</a></span><span class="line">        <span class="mxinfo " id="T97:U167"><span class="var type1" id="S31T97U250">left_pitchlength</span> = <span class="mxinfo " id="T97:U169"><span class="var type1" id="S15T1U252">pitcheslength</span>(<span class="mxinfo " id="T97:U171"><span class="var type1" id="S29T97U254">check_idx</span>-<span class="mxinfo " id="T2:U173">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,53" id="srcline53"> 53</a></span><span class="line">        <span class="mxinfo " id="T97:U174"><span class="var type1" id="S32T97U258">right_pitch</span> = <span class="mxinfo " id="T2:U176">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,54" id="srcline54"> 54</a></span><span class="line">        <span class="mxinfo " id="T97:U177"><span class="var type1" id="S33T97U262">right_pitchlength</span> = <span class="mxinfo " id="T2:U179">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,55" id="srcline55"> 55</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,56" id="srcline56"> 56</a></span><span class="line">        <span class="mxinfo " id="T97:U180"><span class="var type1" id="S30T97U267">left_pitch</span> = <span class="mxinfo " id="T97:U182"><span class="var type1" id="S10T1U269">headpitches</span>(<span class="mxinfo " id="T97:U184"><span class="var type1" id="S29T97U271">check_idx</span>-<span class="mxinfo " id="T2:U186">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo " id="T97:U187"><span class="var type1" id="S31T97U275">left_pitchlength</span> = <span class="mxinfo " id="T97:U189"><span class="var type1" id="S15T1U277">pitcheslength</span>(<span class="mxinfo " id="T97:U191"><span class="var type1" id="S29T97U279">check_idx</span>-<span class="mxinfo " id="T2:U193">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,58" id="srcline58"> 58</a></span><span class="line">        <span class="mxinfo " id="T97:U194"><span class="var type1" id="S32T97U283">right_pitch</span> = <span class="mxinfo " id="T97:U196"><span class="var type1" id="S10T1U285">headpitches</span>(<span class="mxinfo " id="T97:U198"><span class="var type1" id="S29T97U287">check_idx</span>+<span class="mxinfo " id="T2:U200">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,59" id="srcline59"> 59</a></span><span class="line">        <span class="mxinfo " id="T97:U201"><span class="var type1" id="S33T97U291">right_pitchlength</span> = <span class="mxinfo " id="T97:U203"><span class="var type1" id="S15T1U293">pitcheslength</span>(<span class="mxinfo " id="T97:U205"><span class="var type1" id="S29T97U295">check_idx</span>+<span class="mxinfo " id="T2:U207">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,60" id="srcline60"> 60</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,61" id="srcline61"> 61</a></span><span class="line">    <span class="comment">%Smooth Criteria</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,62" id="srcline62"> 62</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo " id="T11:U208">all(<span class="mxinfo " id="T124:U209"><span class="var type1" id="S27T97U303">check_pitch</span> ~= <span class="mxinfo " id="T2:U211">0</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,63" id="srcline63"> 63</a></span><span class="line">        <span class="keyword">if</span>(<span class="mxinfo " id="T11:U212">all(<span class="mxinfo " id="T124:U213"><span class="var type1" id="S30T97U312">left_pitch</span>==<span class="mxinfo " id="T2:U215">0</span></span>)</span> &amp;&amp; <span class="mxinfo " id="T11:U216">all(<span class="mxinfo " id="T124:U217"><span class="var type1" id="S32T97U317">right_pitch</span> == <span class="mxinfo " id="T2:U219">0</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,64" id="srcline64"> 64</a></span><span class="line">            <span class="keyword">if</span>(<span class="mxinfo " id="T11:U220">all(<span class="mxinfo " id="T124:U221"><span class="var type1" id="S28T97U325">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U326">min_length</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,65" id="srcline65"> 65</a></span><span class="line">                <span class="mxinfo " id="T1:U224"><span class="var type1" id="S9T1U329">headidx</span> = <span class="mxinfo " id="T1:U226"><span class="var type1" id="S9T1U331">headidx</span>(<span class="mxinfo " id="T1:U228">[<span class="mxinfo " id="T1:U229">1:<span class="mxinfo " id="T97:U230"><span class="var type1" id="S29T97U337">check_idx</span>-<span class="mxinfo " id="T2:U232">1</span></span></span>, <span class="mxinfo " id="T1:U233"><span class="mxinfo " id="T97:U234"><span class="var type1" id="S29T97U341">check_idx</span>+<span class="mxinfo " id="T2:U236">2</span></span>:<span class="mxinfo " id="T2:U237">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,66" id="srcline66"> 66</a></span><span class="line">                <span class="mxinfo " id="T1:U238"><span class="var type1" id="S10T1U347">headpitches</span> = <span class="mxinfo " id="T1:U240"><span class="var type1" id="S10T1U349">headpitches</span>(<span class="mxinfo " id="T1:U242">[<span class="mxinfo " id="T1:U243">1:<span class="mxinfo " id="T97:U244"><span class="var type1" id="S29T97U355">check_idx</span>-<span class="mxinfo " id="T2:U246">1</span></span></span>, <span class="mxinfo " id="T1:U247"><span class="mxinfo " id="T97:U248"><span class="var type1" id="S29T97U359">check_idx</span>+<span class="mxinfo " id="T2:U250">2</span></span>:<span class="mxinfo " id="T2:U251">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,67" id="srcline67"> 67</a></span><span class="line">                <span class="mxinfo " id="T1:U252"><span class="var type1" id="S17T1U365">visited</span> = <span class="mxinfo " id="T1:U254"><span class="var type1" id="S17T1U367">visited</span>(<span class="mxinfo " id="T1:U256">[<span class="mxinfo " id="T1:U257">1:<span class="mxinfo " id="T97:U258"><span class="var type1" id="S25T97U373">index</span>-<span class="mxinfo " id="T2:U260">1</span></span></span>, <span class="mxinfo " id="T1:U261"><span class="mxinfo " id="T97:U262"><span class="var type1" id="S25T97U377">index</span>+<span class="mxinfo " id="T2:U264">2</span></span>:<span class="mxinfo " id="T2:U265">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,68" id="srcline68"> 68</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,69" id="srcline69"> 69</a></span><span class="line">        <span class="keyword">elseif</span>(<span class="mxinfo " id="T11:U266">all(<span class="mxinfo " id="T124:U267"><span class="var type1" id="S30T97U387">left_pitch</span> ~= <span class="mxinfo " id="T2:U269">0</span></span>)</span> &amp;&amp; <span class="mxinfo " id="T11:U270">all(<span class="mxinfo " id="T124:U271"><span class="var type1" id="S32T97U392">right_pitch</span> == <span class="mxinfo " id="T2:U273">0</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,70" id="srcline70"> 70</a></span><span class="line">            <span class="keyword">if</span>((<span class="mxinfo " id="T11:U274">all(<span class="mxinfo " id="T124:U275"><span class="mxinfo " id="T97:U276"><span class="var type1" id="S28T97U404">check_pitchlength</span>/<span class="var type1" id="S31T97U405">left_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U406">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T11:U280">all(<span class="mxinfo " id="T124:U281"><span class="var type1" id="S28T97U410">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U411">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T11:U284">all(<span class="mxinfo " id="T124:U285"><span class="var type1" id="S28T97U415">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U416">stable_length</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,71" id="srcline71"> 71</a></span><span class="line">                <span class="mxinfo " id="T1:U288"><span class="var type1" id="S9T1U419">headidx</span> = <span class="mxinfo " id="T1:U290"><span class="var type1" id="S9T1U421">headidx</span>(<span class="mxinfo " id="T1:U292">[<span class="mxinfo " id="T1:U293">1:<span class="mxinfo " id="T97:U294"><span class="var type1" id="S29T97U427">check_idx</span>-<span class="mxinfo " id="T2:U296">1</span></span></span>, <span class="mxinfo " id="T1:U297"><span class="mxinfo " id="T97:U298"><span class="var type1" id="S29T97U431">check_idx</span>+<span class="mxinfo " id="T2:U300">1</span></span>:<span class="mxinfo " id="T2:U301">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,72" id="srcline72"> 72</a></span><span class="line">                <span class="mxinfo " id="T1:U302"><span class="var type1" id="S10T1U437">headpitches</span> = <span class="mxinfo " id="T1:U304"><span class="var type1" id="S10T1U439">headpitches</span>(<span class="mxinfo " id="T1:U306">[<span class="mxinfo " id="T1:U307">1:<span class="mxinfo " id="T97:U308"><span class="var type1" id="S29T97U445">check_idx</span>-<span class="mxinfo " id="T2:U310">1</span></span></span>, <span class="mxinfo " id="T1:U311"><span class="mxinfo " id="T97:U312"><span class="var type1" id="S29T97U449">check_idx</span>+<span class="mxinfo " id="T2:U314">1</span></span>:<span class="mxinfo " id="T2:U315">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,73" id="srcline73"> 73</a></span><span class="line">                <span class="mxinfo " id="T1:U316"><span class="var type1" id="S17T1U455">visited</span> = <span class="mxinfo " id="T1:U318"><span class="var type1" id="S17T1U457">visited</span>(<span class="mxinfo " id="T1:U320">[<span class="mxinfo " id="T1:U321">1:<span class="mxinfo " id="T97:U322"><span class="var type1" id="S25T97U463">index</span>-<span class="mxinfo " id="T2:U324">1</span></span></span>, <span class="mxinfo " id="T1:U325"><span class="mxinfo " id="T97:U326"><span class="var type1" id="S25T97U467">index</span>+<span class="mxinfo " id="T2:U328">1</span></span>:<span class="mxinfo " id="T2:U329">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,74" id="srcline74"> 74</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,75" id="srcline75"> 75</a></span><span class="line">        <span class="keyword">elseif</span>(<span class="mxinfo " id="T11:U330">all(<span class="mxinfo " id="T124:U331"><span class="var type1" id="S30T97U477">left_pitch</span> == <span class="mxinfo " id="T2:U333">0</span></span>)</span> &amp;&amp; <span class="mxinfo " id="T11:U334">all(<span class="mxinfo " id="T124:U335"><span class="var type1" id="S32T97U482">right_pitch</span> ~= <span class="mxinfo " id="T2:U337">0</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,76" id="srcline76"> 76</a></span><span class="line">            <span class="keyword">if</span>((<span class="mxinfo " id="T11:U338">all(<span class="mxinfo " id="T124:U339"><span class="mxinfo " id="T97:U340"><span class="var type1" id="S28T97U494">check_pitchlength</span>/<span class="var type1" id="S33T97U495">right_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U496">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T11:U344">all(<span class="mxinfo " id="T124:U345"><span class="var type1" id="S28T97U500">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U501">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T11:U348">all(<span class="mxinfo " id="T124:U349"><span class="var type1" id="S28T97U505">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U506">stable_length</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,77" id="srcline77"> 77</a></span><span class="line">                <span class="mxinfo " id="T97:U352"><span class="var type1" id="S35T97U509">temp</span> = <span class="mxinfo " id="T97:U354"><span class="var type1" id="S9T1U511">headidx</span>(<span class="var type1" id="S29T97U512">check_idx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,78" id="srcline78"> 78</a></span><span class="line">                <span class="mxinfo " id="T1:U357"><span class="var type1" id="S9T1U515">headidx</span> = <span class="mxinfo " id="T1:U359"><span class="var type1" id="S9T1U517">headidx</span>(<span class="mxinfo " id="T1:U361">[<span class="mxinfo " id="T1:U362">1:<span class="mxinfo " id="T97:U363"><span class="var type1" id="S29T97U523">check_idx</span>-<span class="mxinfo " id="T2:U365">1</span></span></span>, <span class="mxinfo " id="T1:U366"><span class="mxinfo " id="T97:U367"><span class="var type1" id="S29T97U527">check_idx</span>+<span class="mxinfo " id="T2:U369">1</span></span>:<span class="mxinfo " id="T2:U370">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,79" id="srcline79"> 79</a></span><span class="line">                <span class="mxinfo " id="T97:U371"><span class="mxinfo " id="T97:U372"><span class="var type1" id="S9T1U534">headidx</span>(<span class="var type1" id="S29T97U535">check_idx</span>)</span> = <span class="var type1" id="S35T97U536">temp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,80" id="srcline80"> 80</a></span><span class="line">                <span class="mxinfo " id="T1:U376"><span class="var type1" id="S10T1U539">headpitches</span> = <span class="mxinfo " id="T1:U378"><span class="var type1" id="S10T1U541">headpitches</span>(<span class="mxinfo " id="T1:U380">[<span class="mxinfo " id="T1:U381">1:<span class="mxinfo " id="T97:U382"><span class="var type1" id="S29T97U547">check_idx</span>-<span class="mxinfo " id="T2:U384">1</span></span></span>, <span class="mxinfo " id="T1:U385"><span class="mxinfo " id="T97:U386"><span class="var type1" id="S29T97U551">check_idx</span>+<span class="mxinfo " id="T2:U388">1</span></span>:<span class="mxinfo " id="T2:U389">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,81" id="srcline81"> 81</a></span><span class="line">                <span class="mxinfo " id="T1:U390"><span class="var type1" id="S17T1U557">visited</span> = <span class="mxinfo " id="T1:U392"><span class="var type1" id="S17T1U559">visited</span>(<span class="mxinfo " id="T1:U394">[<span class="mxinfo " id="T1:U395">1:<span class="mxinfo " id="T97:U396"><span class="var type1" id="S25T97U565">index</span>-<span class="mxinfo " id="T2:U398">1</span></span></span>, <span class="mxinfo " id="T1:U399"><span class="mxinfo " id="T97:U400"><span class="var type1" id="S25T97U569">index</span>+<span class="mxinfo " id="T2:U402">1</span></span>:<span class="mxinfo " id="T2:U403">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,82" id="srcline82"> 82</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,83" id="srcline83"> 83</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,84" id="srcline84"> 84</a></span><span class="line">           <span class="keyword">if</span>(<span class="mxinfo " id="T11:U404">all(<span class="mxinfo " id="T124:U405"><span class="var type1" id="S31T97U580">left_pitchlength</span>&gt;<span class="var type1" id="S33T97U581">right_pitchlength</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,85" id="srcline85"> 85</a></span><span class="line">               <span class="keyword">if</span>((<span class="mxinfo " id="T11:U408">all(<span class="mxinfo " id="T124:U409"><span class="mxinfo " id="T97:U410"><span class="var type1" id="S28T97U592">check_pitchlength</span>/<span class="var type1" id="S31T97U593">left_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U594">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T11:U414">all(<span class="mxinfo " id="T124:U415"><span class="var type1" id="S28T97U598">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U599">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T11:U418">all(<span class="mxinfo " id="T124:U419"><span class="var type1" id="S28T97U603">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U604">stable_length</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,86" id="srcline86"> 86</a></span><span class="line">                    <span class="mxinfo " id="T1:U422"><span class="var type1" id="S9T1U607">headidx</span> = <span class="mxinfo " id="T1:U424"><span class="var type1" id="S9T1U609">headidx</span>(<span class="mxinfo " id="T1:U426">[<span class="mxinfo " id="T1:U427">1:<span class="mxinfo " id="T97:U428"><span class="var type1" id="S29T97U615">check_idx</span>-<span class="mxinfo " id="T2:U430">1</span></span></span>, <span class="mxinfo " id="T1:U431"><span class="mxinfo " id="T97:U432"><span class="var type1" id="S29T97U619">check_idx</span>+<span class="mxinfo " id="T2:U434">1</span></span>:<span class="mxinfo " id="T2:U435">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,87" id="srcline87"> 87</a></span><span class="line">                    <span class="mxinfo " id="T1:U436"><span class="var type1" id="S10T1U625">headpitches</span> = <span class="mxinfo " id="T1:U438"><span class="var type1" id="S10T1U627">headpitches</span>(<span class="mxinfo " id="T1:U440">[<span class="mxinfo " id="T1:U441">1:<span class="mxinfo " id="T97:U442"><span class="var type1" id="S29T97U633">check_idx</span>-<span class="mxinfo " id="T2:U444">1</span></span></span>, <span class="mxinfo " id="T1:U445"><span class="mxinfo " id="T97:U446"><span class="var type1" id="S29T97U637">check_idx</span>+<span class="mxinfo " id="T2:U448">1</span></span>:<span class="mxinfo " id="T2:U449">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,88" id="srcline88"> 88</a></span><span class="line">                    <span class="mxinfo " id="T1:U450"><span class="var type1" id="S17T1U643">visited</span> = <span class="mxinfo " id="T1:U452"><span class="var type1" id="S17T1U645">visited</span>(<span class="mxinfo " id="T1:U454">[<span class="mxinfo " id="T1:U455">1:<span class="mxinfo " id="T97:U456"><span class="var type1" id="S25T97U651">index</span>-<span class="mxinfo " id="T2:U458">1</span></span></span>, <span class="mxinfo " id="T1:U459"><span class="mxinfo " id="T97:U460"><span class="var type1" id="S25T97U655">index</span>+<span class="mxinfo " id="T2:U462">1</span></span>:<span class="mxinfo " id="T2:U463">end</span></span>]</span>)</span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="182,89" id="srcline89"> 89</a></span><span class="line">               <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,90" id="srcline90"> 90</a></span><span class="line">           <span class="keyword">elseif</span>(<span class="mxinfo " id="T11:U464">all(<span class="mxinfo " id="T124:U465"><span class="var type1" id="S31T97U664">left_pitchlength</span> &lt; <span class="var type1" id="S33T97U665">right_pitchlength</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,91" id="srcline91"> 91</a></span><span class="line">               <span class="keyword">if</span>((<span class="mxinfo " id="T11:U468">all(<span class="mxinfo " id="T124:U469"><span class="mxinfo " id="T97:U470"><span class="var type1" id="S28T97U676">check_pitchlength</span>/<span class="var type1" id="S31T97U677">left_pitchlength</span></span>&lt;<span class="var type1" id="S7T2U678">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T11:U474">all(<span class="mxinfo " id="T124:U475"><span class="var type1" id="S28T97U682">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U683">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T11:U478">all(<span class="mxinfo " id="T124:U479"><span class="var type1" id="S28T97U687">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U688">stable_length</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,92" id="srcline92"> 92</a></span><span class="line">                    <span class="mxinfo " id="T97:U482"><span class="var type1" id="S35T97U691">temp</span> = <span class="mxinfo " id="T97:U484"><span class="var type1" id="S9T1U693">headidx</span>(<span class="var type1" id="S29T97U694">check_idx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,93" id="srcline93"> 93</a></span><span class="line">                    <span class="mxinfo " id="T1:U487"><span class="var type1" id="S9T1U697">headidx</span> = <span class="mxinfo " id="T1:U489"><span class="var type1" id="S9T1U699">headidx</span>(<span class="mxinfo " id="T1:U491">[<span class="mxinfo " id="T1:U492">1:<span class="mxinfo " id="T97:U493"><span class="var type1" id="S29T97U705">check_idx</span>-<span class="mxinfo " id="T2:U495">1</span></span></span>, <span class="mxinfo " id="T1:U496"><span class="mxinfo " id="T97:U497"><span class="var type1" id="S29T97U709">check_idx</span>+<span class="mxinfo " id="T2:U499">1</span></span>:<span class="mxinfo " id="T2:U500">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,94" id="srcline94"> 94</a></span><span class="line">                    <span class="mxinfo " id="T97:U501"><span class="mxinfo " id="T97:U502"><span class="var type1" id="S9T1U716">headidx</span>(<span class="var type1" id="S29T97U717">check_idx</span>)</span> = <span class="var type1" id="S35T97U718">temp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,95" id="srcline95"> 95</a></span><span class="line">                    <span class="mxinfo " id="T1:U506"><span class="var type1" id="S10T1U721">headpitches</span> = <span class="mxinfo " id="T1:U508"><span class="var type1" id="S10T1U723">headpitches</span>(<span class="mxinfo " id="T1:U510">[<span class="mxinfo " id="T1:U511">1:<span class="mxinfo " id="T97:U512"><span class="var type1" id="S29T97U729">check_idx</span>-<span class="mxinfo " id="T2:U514">1</span></span></span>, <span class="mxinfo " id="T1:U515"><span class="mxinfo " id="T97:U516"><span class="var type1" id="S29T97U733">check_idx</span>+<span class="mxinfo " id="T2:U518">1</span></span>:<span class="mxinfo " id="T2:U519">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,96" id="srcline96"> 96</a></span><span class="line">                    <span class="mxinfo " id="T1:U520"><span class="var type1" id="S17T1U739">visited</span> = <span class="mxinfo " id="T1:U522"><span class="var type1" id="S17T1U741">visited</span>(<span class="mxinfo " id="T1:U524">[<span class="mxinfo " id="T1:U525">1:<span class="mxinfo " id="T97:U526"><span class="var type1" id="S25T97U747">index</span>-<span class="mxinfo " id="T2:U528">1</span></span></span>, <span class="mxinfo " id="T1:U529"><span class="mxinfo " id="T97:U530"><span class="var type1" id="S25T97U751">index</span>+<span class="mxinfo " id="T2:U532">1</span></span>:<span class="mxinfo " id="T2:U533">end</span></span>]</span>)</span></span>;                   </span></span>
<span class="srcline"><span class="lineno"><a href="182,97" id="srcline97"> 97</a></span><span class="line">               <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,98" id="srcline98"> 98</a></span><span class="line">           <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,99" id="srcline99"> 99</a></span><span class="line">               <span class="keyword">if</span>((<span class="mxinfo " id="T11:U534">all(<span class="mxinfo " id="T124:U535"><span class="mxinfo " id="T97:U536"><span class="var type1" id="S28T97U766">check_pitchlength</span>/(<span class="mxinfo " id="T97:U538"><span class="var type1" id="S31T97U769">left_pitchlength</span>+<span class="var type1" id="S33T97U770">right_pitchlength</span></span>)</span>&lt;<span class="var type1" id="S7T2U771">absorb_threshold</span></span>)</span>||<span class="mxinfo " id="T11:U542">all(<span class="mxinfo " id="T124:U543"><span class="var type1" id="S28T97U775">check_pitchlength</span>&lt;<span class="var type1" id="S5T2U776">min_length</span></span>)</span>)&amp;&amp;<span class="mxinfo " id="T11:U546">all(<span class="mxinfo " id="T124:U547"><span class="var type1" id="S28T97U780">check_pitchlength</span>&lt;<span class="var type1" id="S6T2U781">stable_length</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,100" id="srcline100">100</a></span><span class="line">                   <span class="mxinfo " id="T1:U550"><span class="var type1" id="S9T1U784">headidx</span> = <span class="mxinfo " id="T1:U552"><span class="var type1" id="S9T1U786">headidx</span>(<span class="mxinfo " id="T1:U554">[<span class="mxinfo " id="T1:U555">1:<span class="mxinfo " id="T97:U556"><span class="var type1" id="S29T97U792">check_idx</span>-<span class="mxinfo " id="T2:U558">1</span></span></span>, <span class="mxinfo " id="T1:U559"><span class="mxinfo " id="T97:U560"><span class="var type1" id="S29T97U796">check_idx</span>+<span class="mxinfo " id="T2:U562">2</span></span>:<span class="mxinfo " id="T2:U563">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,101" id="srcline101">101</a></span><span class="line">                   <span class="mxinfo " id="T1:U564"><span class="var type1" id="S10T1U802">headpitches</span> = <span class="mxinfo " id="T1:U566"><span class="var type1" id="S10T1U804">headpitches</span>(<span class="mxinfo " id="T1:U568">[<span class="mxinfo " id="T1:U569">1:<span class="mxinfo " id="T97:U570"><span class="var type1" id="S29T97U810">check_idx</span>-<span class="mxinfo " id="T2:U572">1</span></span></span>, <span class="mxinfo " id="T1:U573"><span class="mxinfo " id="T97:U574"><span class="var type1" id="S29T97U814">check_idx</span>+<span class="mxinfo " id="T2:U576">2</span></span>:<span class="mxinfo " id="T2:U577">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,102" id="srcline102">102</a></span><span class="line">                   <span class="mxinfo " id="T1:U578"><span class="var type1" id="S17T1U820">visited</span> = <span class="mxinfo " id="T1:U580"><span class="var type1" id="S17T1U822">visited</span>(<span class="mxinfo " id="T1:U582">[<span class="mxinfo " id="T1:U583">1:<span class="mxinfo " id="T97:U584"><span class="var type1" id="S25T97U828">index</span>-<span class="mxinfo " id="T2:U586">1</span></span></span>, <span class="mxinfo " id="T1:U587"><span class="mxinfo " id="T97:U588"><span class="var type1" id="S25T97U832">index</span>+<span class="mxinfo " id="T2:U590">2</span></span>:<span class="mxinfo " id="T2:U591">end</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,103" id="srcline103">103</a></span><span class="line">               <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,104" id="srcline104">104</a></span><span class="line">           <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,105" id="srcline105">105</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,106" id="srcline106">106</a></span><span class="line"><span class="comment">%     elseif(check_idx~=1&amp;&amp;check_idx~=length(headidx))</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,107" id="srcline107">107</a></span><span class="line"><span class="comment">%            if(left_pitchlength&gt;right_pitchlength)</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,108" id="srcline108">108</a></span><span class="line"><span class="comment">%                if(((check_pitchlength/left_pitchlength&lt;absorb_threshold)||check_pitchlength&lt;min_length)&amp;&amp;check_pitchlength&lt;stable_length)</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,109" id="srcline109">109</a></span><span class="line"><span class="comment">%                     headidx = headidx([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,110" id="srcline110">110</a></span><span class="line"><span class="comment">%                     headpitches = headpitches([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,111" id="srcline111">111</a></span><span class="line"><span class="comment">%                     visited = visited([1:index-1, index+1:end]);             </span></span></span>
<span class="srcline"><span class="lineno"><a href="182,112" id="srcline112">112</a></span><span class="line"><span class="comment">%                end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,113" id="srcline113">113</a></span><span class="line"><span class="comment">%            elseif(left_pitchlength &lt; right_pitchlength)</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,114" id="srcline114">114</a></span><span class="line"><span class="comment">%                if(((check_pitchlength/left_pitchlength&lt;absorb_threshold)||check_pitchlength&lt;min_length)&amp;&amp;check_pitchlength&lt;stable_length)</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,115" id="srcline115">115</a></span><span class="line"><span class="comment">%                     temp = headidx(check_idx);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,116" id="srcline116">116</a></span><span class="line"><span class="comment">%                     headidx = headidx([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,117" id="srcline117">117</a></span><span class="line"><span class="comment">%                     headidx(check_idx) = temp;</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,118" id="srcline118">118</a></span><span class="line"><span class="comment">%                     headpitches = headpitches([1:check_idx-1, check_idx+1:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,119" id="srcline119">119</a></span><span class="line"><span class="comment">%                     visited = visited([1:index-1, index+1:end]);                   </span></span></span>
<span class="srcline"><span class="lineno"><a href="182,120" id="srcline120">120</a></span><span class="line"><span class="comment">%                end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,121" id="srcline121">121</a></span><span class="line"><span class="comment">%            else</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,122" id="srcline122">122</a></span><span class="line"><span class="comment">%                if(((check_pitchlength/(left_pitchlength+right_pitchlength)&lt;absorb_threshold)||check_pitchlength&lt;min_length)&amp;&amp;check_pitchlength&lt;stable_length)</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,123" id="srcline123">123</a></span><span class="line"><span class="comment">%                    headidx = headidx([1:check_idx-1, check_idx+2:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,124" id="srcline124">124</a></span><span class="line"><span class="comment">%                    headpitches = headpitches([1:check_idx-1, check_idx+2:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,125" id="srcline125">125</a></span><span class="line"><span class="comment">%                    visited = visited([1:index-1, index+2:end]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,126" id="srcline126">126</a></span><span class="line"><span class="comment">%                end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,127" id="srcline127">127</a></span><span class="line"><span class="comment">%            end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,128" id="srcline128">128</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,129" id="srcline129">129</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="182,130" id="srcline130">130</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,131" id="srcline131">131</a></span><span class="line"><span class="mxinfo " id="T1:U592"><span class="var type1" id="S2T1U838">out</span> = <span class="mxinfo " id="T1:U594">zeros(<span class="mxinfo " id="T2:U595">1</span>,<span class="mxinfo " id="T2:U596">length(<span class="var type1" id="S3T1U844">arr</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,132" id="srcline132">132</a></span><span class="line"><span class="mxinfo " id="T1:U598"><span class="var type1" id="S14T1U847">tmp_headidx</span> = <span class="mxinfo " id="T1:U600">[<span class="var type1" id="S9T1U850">headidx</span> <span class="mxinfo " id="T2:U602">length(<span class="var type1" id="S3T1U853">arr</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,133" id="srcline133">133</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T2U856">i</span>=<span class="mxinfo " id="T2:U605">1</span>:length(<span class="var type1" id="S9T1U861">headidx</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo " id="T1:U607"><span class="mxinfo " id="T1:U608"><span class="var type1" id="S2T1U865">out</span>(<span class="mxinfo " id="T1:U610"><span class="mxinfo " id="T2:U611"><span class="var type1" id="S14T1U868">tmp_headidx</span>(<span class="var type1" id="S11T2U869">i</span>)</span>:<span class="mxinfo " id="T2:U614"><span class="var type1" id="S14T1U871">tmp_headidx</span>(<span class="mxinfo " id="T2:U616"><span class="var type1" id="S11T2U873">i</span>+<span class="mxinfo " id="T2:U618">1</span></span>)</span></span>)</span> = <span class="mxinfo " id="T1:U619"><span class="mxinfo " id="T2:U620"><span class="var type1" id="S10T1U877">headpitches</span>(<span class="var type1" id="S11T2U878">i</span>)</span>.*<span class="mxinfo " id="T1:U623">ones(<span class="mxinfo " id="T2:U624">1</span>,<span class="mxinfo " id="T2:U625"><span class="mxinfo " id="T2:U626"><span class="mxinfo " id="T2:U627"><span class="var type1" id="S14T1U885">tmp_headidx</span>(<span class="mxinfo " id="T2:U629"><span class="var type1" id="S11T2U887">i</span>+<span class="mxinfo " id="T2:U631">1</span></span>)</span>-<span class="mxinfo " id="T2:U632"><span class="var type1" id="S14T1U890">tmp_headidx</span>(<span class="var type1" id="S11T2U891">i</span>)</span></span>+<span class="mxinfo " id="T2:U635">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,135" id="srcline135">135</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,136" id="srcline136">136</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="182,137" id="srcline137">137</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="182,138" id="srcline138">138</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="182,139" id="srcline139">139</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="182,140" id="srcline140">140</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="182,141" id="srcline141">141</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
